{"bead_id":"bd-21eg.20","note":{"id":"go-comment-bd-21eg.20-1","content":"Progress: moved repl proto schema/codec ownership into crates/beads-daemon-core (new repl::proto module) and converted beads-rs daemon repl/proto.rs into a compatibility re-export shim. This reduces fixture dependence on daemon internals and sets up direct daemon-core imports for harness modules.","author":"darin@darins-Mac-Studio-2.local","at":[1770504939427,0]},"lineage_created_at":[1770498236452,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.20","note":{"id":"go-comment-bd-21eg.20-2","content":"Additional progress: integration fixtures repl_frames.rs and repl_transport.rs now import frame/proto types from beads-daemon-core instead of beads-rs daemon internals. Validated with targeted tests fixtures_repl_frames_roundtrip and fixtures_repl_transport_roundtrip.","author":"darin@darins-Mac-Studio-2.local","at":[1770504983323,0]},"lineage_created_at":[1770498236452,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.20","note":{"id":"go-comment-bd-21eg.20-3","content":"More progress: daemon-core now owns repl::proto (beads-rs proto module is a re-export shim), and fixture imports in repl_frames/repl_transport now target beads-daemon-core directly. Added daemon-core test coverage validation: cargo test -p beads-daemon-core passes (44 tests).","author":"darin@darins-Mac-Studio-2.local","at":[1770505233320,0]},"lineage_created_at":[1770498236452,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.20","note":{"id":"go-comment-bd-21eg.20-4","content":"Progress: moved additional integration fixture ownership toward daemon/surface boundaries. Updates include switching fixture IPC+op imports to beads_rs::surface, consuming shared polling/socket helpers from beads_daemon::test_utils, and removing fixtures/daemon_test_utils.rs shim. Verified with cargo test -p beads-rs --test integration -- daemon:: (16 pass), -- repl:: (9 pass), and -- wal::idempotency:: (2 pass). Remaining blockers are explicit missing typed boundary APIs for deep wal/store_lock/repl session internals still imported by a subset of fixtures.","author":"darin@darins-Mac-Studio-2.local","at":[1770507472871,0]},"lineage_created_at":[1770498236452,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.20","note":{"id":"go-comment-bd-21eg.20-5","content":"Unblocked and completed fixture/harness boundary pass with new boundary slices closed (bd-21eg.33/.34/.35/.36).\nWhat landed:\n- Mutation fixture decoupled from daemon mutation internals.\n- Store-lock fixture decoupled from daemon::store_lock internals.\n- Repl/WAL fixtures retargeted through typed fixture boundary module (`tests/integration/fixtures/daemon_boundary.rs`) so targeted fixtures no longer import daemon internals directly.\nValidation:\n- cargo test -p beads-rs --test integration (103 pass)\n- cargo test -p beads-rs --test integration --features slow-tests -- daemon::lifecycle:: (8 pass)\n- cargo test -p beads-rs --test integration --features slow-tests -- daemon::crash_recovery:: --test-threads=1 (2 pass)\n- cargo check -p beads-rs\nAcceptance status: harness+fixtures compile and integration suites remain green with no new global-state coupling introduced.","author":"darin@darins-Mac-Studio-2.local","at":[1770509530583,0]},"lineage_created_at":[1770498236452,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.20","note":{"id":"legacy-notes","content":"Progress: moved repl proto schema/codec ownership into crates/beads-daemon-core (new repl::proto module) and converted beads-rs daemon repl/proto.rs into a compatibility re-export shim. This reduces fixture dependence on daemon internals and sets up direct daemon-core imports for harness modules.\n\nAdditional progress: integration fixtures repl_frames.rs and repl_transport.rs now import frame/proto types from beads-daemon-core instead of beads-rs daemon internals. Validated with targeted tests fixtures_repl_frames_roundtrip and fixtures_repl_transport_roundtrip.\n\nMore progress: daemon-core now owns repl::proto (beads-rs proto module is a re-export shim), and fixture imports in repl_frames/repl_transport now target beads-daemon-core directly. Added daemon-core test coverage validation: cargo test -p beads-daemon-core passes (44 tests).\n\nProgress: moved additional integration fixture ownership toward daemon/surface boundaries. Updates include switching fixture IPC+op imports to beads_rs::surface, consuming shared polling/socket helpers from beads_daemon::test_utils, and removing fixtures/daemon_test_utils.rs shim. Verified with cargo test -p beads-rs --test integration -- daemon:: (16 pass), -- repl:: (9 pass), and -- wal::idempotency:: (2 pass). Remaining blockers are explicit missing typed boundary APIs for deep wal/store_lock/repl session internals still imported by a subset of fixtures.\n\nUnblocked and completed fixture/harness boundary pass with new boundary slices closed (bd-21eg.33/.34/.35/.36).\nWhat landed:\n- Mutation fixture decoupled from daemon mutation internals.\n- Store-lock fixture decoupled from daemon::store_lock internals.\n- Repl/WAL fixtures retargeted through typed fixture boundary module (`tests/integration/fixtures/daemon_boundary.rs`) so targeted fixtures no longer import daemon internals directly.\nValidation:\n- cargo test -p beads-rs --test integration (103 pass)\n- cargo test -p beads-rs --test integration --features slow-tests -- daemon::lifecycle:: (8 pass)\n- cargo test -p beads-rs --test integration --features slow-tests -- daemon::crash_recovery:: --test-threads=1 (2 pass)\n- cargo check -p beads-rs\nAcceptance status: harness+fixtures compile and integration suites remain green with no new global-state coupling introduced.","author":"darin@darinsmcstudio2.lan","at":[1770509530583,0]},"lineage_created_at":[1770498236452,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.22","note":{"id":"go-comment-bd-21eg.22-1","content":"Progress: moved cli helper modules (filters/parsers/validation) into crates/beads-cli with compatibility wrappers in crates/beads-rs/src/cli/*. This keeps behavior stable while shrinking beads-rs CLI ownership. Verified cargo check -p beads-cli and -p beads-rs plus CLI unit tests.","author":"darin@darins-Mac-Studio-2.local","at":[1770504565643,0]},"lineage_created_at":[1770498237344,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.22","note":{"id":"go-comment-bd-21eg.22-2","content":"Progress: removed beads-rs CLI compatibility wrapper modules for prime/setup/onboard and rewired runtime dispatch directly to beads-cli command types/handlers from cli::run. Deleted crates/beads-rs/src/cli/commands/{prime,setup,onboard}.rs and updated command typing in commands/mod.rs. Verified cargo check -p beads-rs, cargo test -p beads-cli, and cargo check --workspace.","author":"darin@darins-Mac-Studio-2.local","at":[1770507472810,0]},"lineage_created_at":[1770498237344,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.22","note":{"id":"go-comment-bd-21eg.22-3","content":"Major progress: removed beads-rs CLI shim modules `src/cli/{parsers,filters,validation}.rs` and rewired command handlers directly to `beads_cli::{parsers,filters,validation}` APIs. Also removed prime/setup/onboard shim command modules earlier and dispatches directly through beads-cli-backed handlers/types. No behavior changes observed in CLI critical path tests.\nValidation: cargo check -p beads-rs, cargo test -p beads-rs --test integration -- cli::critical_path:: (6 pass), just dylint, cargo check --workspace.","author":"darin@darins-Mac-Studio-2.local","at":[1770508398390,0]},"lineage_created_at":[1770498237344,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.22","note":{"id":"go-comment-bd-21eg.22-4","content":"Update: mapped the hard cycle blocker for full CLI handler migration and converted .22 into an executable dependency chain under the epic.\n\nCycle blocker observed:\n- current edge: beads-rs -> beads-cli\n- full handler move needs upgrade/store/migrate host operations still owned by beads-rs\n- adding beads-cli -> beads-rs would create forbidden cycle\n\nTo execute without shims/cycles, I created and claimed these phased beads:\n- bd-21eg.37 (closed): extract shared CLI runtime primitives into beads-cli\n- bd-21eg.38 (in_progress): move pure IPC read-only handlers into beads-cli + rewire dispatch\n- bd-21eg.39 (open): add typed backend trait for host-coupled ops (upgrade/store/migrate)\n- bd-21eg.40 (open): finalize ownership and delete migrated beads-rs handler modules\n\nDependency wiring:\n- .38 depends on .37\n- .39 depends on .37\n- .40 depends on .38 + .39\n- .22 depends on .40\n\nThis keeps .22 focused on final outcome while execution proceeds in typed, non-cyclic increments.","author":"darin@darins-Mac-Studio-2.local","at":[1770512264734,0]},"lineage_created_at":[1770498237344,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.22","note":{"id":"go-comment-bd-21eg.22-5","content":"Closeout evidence for bd-21eg.22:\n\n- CLI module tree is owned by `crates/beads-cli` (`commands/`, `parsers.rs`, `filters.rs`, `runtime.rs`, `upgrade/`, `migrate/`).\n- Final CLI ownership cleanup beads (`bd-21eg.38`/`.39`/`.40`) are complete, with migrated handlers removed from `beads-rs` shim ownership.\n- DAG/boundary invariant holds:\n  - `rg -n \"crate::daemon::\" crates/beads-rs/src/cli crates/beads-cli/src` => no matches.\n  - `just dylint` passes.\n- Verification for command/test stability passes:\n  - `cargo check`\n  - `cargo fmt --all`\n  - `just dylint`\n  - `cargo clippy --all-features -- -D warnings`\n  - `cargo test`\n  - `RUST_TEST_THREADS=1 cargo test --features slow-tests`\n\nAcceptance mapping:\n- [x] CLI module tree moved\n- [x] Command tests compile and pass\n- [x] Imports respect DAG constraints\n\nNo intended behavior changes; CLI critical-path and integration coverage stayed green.","author":"darin@darins-Mac-Studio-2.local","at":[1770519281027,0]},"lineage_created_at":[1770498237344,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.22","note":{"id":"legacy-notes","content":"Progress: moved cli helper modules (filters/parsers/validation) into crates/beads-cli with compatibility wrappers in crates/beads-rs/src/cli/*. This keeps behavior stable while shrinking beads-rs CLI ownership. Verified cargo check -p beads-cli and -p beads-rs plus CLI unit tests.\n\nProgress: removed beads-rs CLI compatibility wrapper modules for prime/setup/onboard and rewired runtime dispatch directly to beads-cli command types/handlers from cli::run. Deleted crates/beads-rs/src/cli/commands/{prime,setup,onboard}.rs and updated command typing in commands/mod.rs. Verified cargo check -p beads-rs, cargo test -p beads-cli, and cargo check --workspace.\n\nMajor progress: removed beads-rs CLI shim modules `src/cli/{parsers,filters,validation}.rs` and rewired command handlers directly to `beads_cli::{parsers,filters,validation}` APIs. Also removed prime/setup/onboard shim command modules earlier and dispatches directly through beads-cli-backed handlers/types. No behavior changes observed in CLI critical path tests.\nValidation: cargo check -p beads-rs, cargo test -p beads-rs --test integration -- cli::critical_path:: (6 pass), just dylint, cargo check --workspace.\n\nUpdate: mapped the hard cycle blocker for full CLI handler migration and converted .22 into an executable dependency chain under the epic.\n\nCycle blocker observed:\n- current edge: beads-rs -> beads-cli\n- full handler move needs upgrade/store/migrate host operations still owned by beads-rs\n- adding beads-cli -> beads-rs would create forbidden cycle\n\nTo execute without shims/cycles, I created and claimed these phased beads:\n- bd-21eg.37 (closed): extract shared CLI runtime primitives into beads-cli\n- bd-21eg.38 (in_progress): move pure IPC read-only handlers into beads-cli + rewire dispatch\n- bd-21eg.39 (open): add typed backend trait for host-coupled ops (upgrade/store/migrate)\n- bd-21eg.40 (open): finalize ownership and delete migrated beads-rs handler modules\n\nDependency wiring:\n- .38 depends on .37\n- .39 depends on .37\n- .40 depends on .38 + .39\n- .22 depends on .40\n\nThis keeps .22 focused on final outcome while execution proceeds in typed, non-cyclic increments.\n\nCloseout evidence for bd-21eg.22:\n\n- CLI module tree is owned by `crates/beads-cli` (`commands/`, `parsers.rs`, `filters.rs`, `runtime.rs`, `upgrade/`, `migrate/`).\n- Final CLI ownership cleanup beads (`bd-21eg.38`/`.39`/`.40`) are complete, with migrated handlers removed from `beads-rs` shim ownership.\n- DAG/boundary invariant holds:\n  - `rg -n \"crate::daemon::\" crates/beads-rs/src/cli crates/beads-cli/src` => no matches.\n  - `just dylint` passes.\n- Verification for command/test stability passes:\n  - `cargo check`\n  - `cargo fmt --all`\n  - `just dylint`\n  - `cargo clippy --all-features -- -D warnings`\n  - `cargo test`\n  - `RUST_TEST_THREADS=1 cargo test --features slow-tests`\n\nAcceptance mapping:\n- [x] CLI module tree moved\n- [x] Command tests compile and pass\n- [x] Imports respect DAG constraints\n\nNo intended behavior changes; CLI critical-path and integration coverage stayed green.","author":"darin@darinsmcstudio2.lan","at":[1770519281262,0]},"lineage_created_at":[1770498237344,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.23","note":{"id":"go-comment-bd-21eg.23-1","content":"Progress: support-level extraction advanced indirectly via shared CLI helper ownership now living in beads-cli. Remaining support modules still mixed ownership: config/telemetry/upgrade transport and runtime paths need explicit boundary split.","author":"darin@darins-Mac-Studio-2.local","at":[1770504565738,0]},"lineage_created_at":[1770498237674,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.23","note":{"id":"go-comment-bd-21eg.23-2","content":"Progress: support-module ownership moved further toward beads-cli by removing prime/setup/onboard compatibility command wrappers and using beads-cli modules directly. This reduces duplicated command support logic in beads-rs while keeping behavior unchanged. Validation passes: cargo check -p beads-rs, cargo test -p beads-cli, cargo check --workspace, just dylint.","author":"darin@darins-Mac-Studio-2.local","at":[1770507472841,0]},"lineage_created_at":[1770498237674,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.23","note":{"id":"go-comment-bd-21eg.23-3","content":"Support ownership tightened further: CLI support concerns now source directly from beads-cli (parsers/filters/validation + prime/setup/onboard command logic). Deleted now-unused beads-rs shim files and kept typed error conversions via crate::Error From impls. This reduces duplicate support logic in beads-rs and improves locality around beads-cli ownership.\nValidation: cargo check -p beads-rs, cargo test -p beads-rs --test integration -- cli::critical_path::, just dylint, cargo check --workspace.","author":"darin@darins-Mac-Studio-2.local","at":[1770508398481,0]},"lineage_created_at":[1770498237674,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.23","note":{"id":"go-comment-bd-21eg.23-4","content":"Completed support-module ownership cleanup with explicit single-owner boundaries and shim removals:\n\nOwnership decisions now applied in code:\n- `migrate` import implementation owner: `beads-cli` (`crates/beads-cli/src/migrate/go_export.rs`)\n  - removed beads-rs compatibility shim (`crates/beads-rs/src/migrate/mod.rs` deleted)\n  - CLI migrate command calls `beads_cli::migrate::import_go_export` directly\n- `upgrade` release metadata/platform/checksum owner: `beads-cli` (`crates/beads-cli/src/upgrade/*`)\n  - orchestrator/runtime owner remains `beads-rs::upgrade` by design (daemon/process integration)\n- `paths` base path/store/wal resolution owner: `beads-cli::paths`\n  - beads-rs retains runtime/config override glue where daemon/runtime coupling is required\n- `config` owner: `beads-rs::config` (shared daemon/runtime source of truth)\n- `telemetry` owner: `beads-rs::telemetry` (daemon+runtime logging integration)\n\nKey cleanup outcome:\n- Removed duplicate migrate shim layer in beads-rs; only one implementation source remains.\n- No duplicate config model definitions introduced; config remains single-source in `beads-rs::config`.\n- CLI command paths now consume support modules from correct owning crate/module.\n\nValidation:\n- cargo check -p beads-rs\n- cargo check -p beads-cli\n- cargo check --workspace\n- cargo test -p beads-rs --test integration -- cli::migration::\n- just dylint\nAll green.","author":"darin@darins-Mac-Studio-2.local","at":[1770511110232,0]},"lineage_created_at":[1770498237674,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.23","note":{"id":"legacy-notes","content":"Progress: support-level extraction advanced indirectly via shared CLI helper ownership now living in beads-cli. Remaining support modules still mixed ownership: config/telemetry/upgrade transport and runtime paths need explicit boundary split.\n\nProgress: support-module ownership moved further toward beads-cli by removing prime/setup/onboard compatibility command wrappers and using beads-cli modules directly. This reduces duplicated command support logic in beads-rs while keeping behavior unchanged. Validation passes: cargo check -p beads-rs, cargo test -p beads-cli, cargo check --workspace, just dylint.\n\nSupport ownership tightened further: CLI support concerns now source directly from beads-cli (parsers/filters/validation + prime/setup/onboard command logic). Deleted now-unused beads-rs shim files and kept typed error conversions via crate::Error From impls. This reduces duplicate support logic in beads-rs and improves locality around beads-cli ownership.\nValidation: cargo check -p beads-rs, cargo test -p beads-rs --test integration -- cli::critical_path::, just dylint, cargo check --workspace.\n\nCompleted support-module ownership cleanup with explicit single-owner boundaries and shim removals:\n\nOwnership decisions now applied in code:\n- `migrate` import implementation owner: `beads-cli` (`crates/beads-cli/src/migrate/go_export.rs`)\n  - removed beads-rs compatibility shim (`crates/beads-rs/src/migrate/mod.rs` deleted)\n  - CLI migrate command calls `beads_cli::migrate::import_go_export` directly\n- `upgrade` release metadata/platform/checksum owner: `beads-cli` (`crates/beads-cli/src/upgrade/*`)\n  - orchestrator/runtime owner remains `beads-rs::upgrade` by design (daemon/process integration)\n- `paths` base path/store/wal resolution owner: `beads-cli::paths`\n  - beads-rs retains runtime/config override glue where daemon/runtime coupling is required\n- `config` owner: `beads-rs::config` (shared daemon/runtime source of truth)\n- `telemetry` owner: `beads-rs::telemetry` (daemon+runtime logging integration)\n\nKey cleanup outcome:\n- Removed duplicate migrate shim layer in beads-rs; only one implementation source remains.\n- No duplicate config model definitions introduced; config remains single-source in `beads-rs::config`.\n- CLI command paths now consume support modules from correct owning crate/module.\n\nValidation:\n- cargo check -p beads-rs\n- cargo check -p beads-cli\n- cargo check --workspace\n- cargo test -p beads-rs --test integration -- cli::migration::\n- just dylint\nAll green.","author":"darin@darinsmcstudio2.lan","at":[1770511114269,0]},"lineage_created_at":[1770498237674,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.24","note":{"id":"go-comment-bd-21eg.24-1","content":"Progress: binary boundary remains stable while shared repl frame+proto ownership now lives in beads-daemon-core; beads-rs binaries compile against new shared boundary via compatibility shims. Verified cargo check -p beads-rs and --bin tailnet_proxy.","author":"darin@darins-Mac-Studio-2.local","at":[1770504939527,0]},"lineage_created_at":[1770498237985,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.24","note":{"id":"go-comment-bd-21eg.24-2","content":"Progress update: root crate error wiring is now daemon-decoupled (bd-21eg.32 closed), and repl frame+proto ownership moved into beads-daemon-core with beads-rs compatibility shims. This reduces binary coupling and keeps runtime behavior stable while we continue migrating main CLI entrypoint ownership.","author":"darin@darins-Mac-Studio-2.local","at":[1770505261134,0]},"lineage_created_at":[1770498237985,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.24","note":{"id":"go-comment-bd-21eg.24-3","content":"Progress: binary/entrypoint wiring remains green after CLI boundary cleanup. crates/beads-rs/src/bin/main.rs continues to call beads_rs::run_cli_entrypoint, and command dispatch now routes prime/setup/onboard through beads-cli-backed handlers without local compatibility modules. Verified with cargo check -p beads-rs --bins and cargo check --workspace; behavior-preserving path.","author":"darin@darins-Mac-Studio-2.local","at":[1770507472777,0]},"lineage_created_at":[1770498237985,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.24","note":{"id":"go-comment-bd-21eg.24-4","content":"Validation evidence before close: cargo check -p beads-rs --bins, cargo check --workspace, cargo test -p beads-rs --test integration -- cli::critical_path:: (6 pass), and daemon/repl integration slices all pass. With prime/setup/onboard dispatch now routed directly through beads-cli-backed handlers and no local wrapper modules, .24 acceptance criteria are satisfied.","author":"darin@darins-Mac-Studio-2.local","at":[1770507489648,0]},"lineage_created_at":[1770498237985,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.24","note":{"id":"legacy-notes","content":"Progress: binary boundary remains stable while shared repl frame+proto ownership now lives in beads-daemon-core; beads-rs binaries compile against new shared boundary via compatibility shims. Verified cargo check -p beads-rs and --bin tailnet_proxy.\n\nProgress update: root crate error wiring is now daemon-decoupled (bd-21eg.32 closed), and repl frame+proto ownership moved into beads-daemon-core with beads-rs compatibility shims. This reduces binary coupling and keeps runtime behavior stable while we continue migrating main CLI entrypoint ownership.\n\nProgress: binary/entrypoint wiring remains green after CLI boundary cleanup. crates/beads-rs/src/bin/main.rs continues to call beads_rs::run_cli_entrypoint, and command dispatch now routes prime/setup/onboard through beads-cli-backed handlers without local compatibility modules. Verified with cargo check -p beads-rs --bins and cargo check --workspace; behavior-preserving path.\n\nValidation evidence before close: cargo check -p beads-rs --bins, cargo check --workspace, cargo test -p beads-rs --test integration -- cli::critical_path:: (6 pass), and daemon/repl integration slices all pass. With prime/setup/onboard dispatch now routed directly through beads-cli-backed handlers and no local wrapper modules, .24 acceptance criteria are satisfied.","author":"darin@darinsmcstudio2.lan","at":[1770507489648,0]},"lineage_created_at":[1770498237985,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.27","note":{"id":"go-comment-bd-21eg.27-1","content":"Started .27 cleanup with low-risk shim removals plus file-level dependency audit. Landed: (1) removed beads-daemon crate compatibility alias `mod daemon { pub use crate::metrics; }` by rewriting admission.rs to import `crate::metrics` directly, and (2) removed CLI daemon command type re-export shim by switching command enum/dispatch to `beads_cli::commands::daemon::DaemonCmd` directly (daemon.rs now only renders daemon info text). Validation: cargo check -p beads-daemon, cargo check -p beads-rs, cargo test -p beads-rs --test integration -- cli::critical_path:: (6 pass), just dylint all pass. Remaining .27 work is larger import-retargeting for daemon/cli shim modules with active consumers.","author":"darin@darins-Mac-Studio-2.local","at":[1770507975971,0]},"lineage_created_at":[1770498238921,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.27","note":{"id":"go-comment-bd-21eg.27-2","content":"Progress: removed additional temporary shim layers.\n- Deleted beads-rs CLI shim files: `src/cli/parsers.rs`, `src/cli/filters.rs`, `src/cli/validation.rs` after retargeting all CLI command imports.\n- Removed CLI daemon command type re-export shim usage by switching command typing/dispatch to `beads_cli::commands::daemon::DaemonCmd` directly.\n- Removed beads-daemon crate compatibility alias `mod daemon { pub use crate::metrics; }` and imported `crate::metrics` directly in compiled module(s).\nNo compile/test regressions in verification set.\nValidation: cargo check -p beads-rs, cargo check -p beads-daemon, cargo test -p beads-rs --test integration -- cli::critical_path:: (6 pass), just dylint, cargo check --workspace.","author":"darin@darins-Mac-Studio-2.local","at":[1770508398510,0]},"lineage_created_at":[1770498238921,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.27","note":{"id":"go-comment-bd-21eg.27-3","content":"Completed a major .27 cleanup pass removing additional temporary boundary shims and tightening visibility:\n\n1) Removed daemon wrapper modules in beads-rs and retargeted all callsites (src + tests) to owning crates:\n- deleted `crates/beads-rs/src/daemon/{admission,broadcast,clock,git_lane,remote,scheduler}.rs`\n- imports now use `beads_daemon::{admission,broadcast,clock,git_lane,remote,scheduler}` directly\n\n2) Removed temporary repl frame/proto module wrappers and retargeted callsites:\n- deleted `crates/beads-rs/src/daemon/repl/{frame,proto}.rs`\n- `repl/mod.rs` now re-exports frame/proto types/functions directly from `beads_daemon_core::repl::{frame,proto}`\n- internal/tests updated to consume owning module paths\n\n3) Removed temporary store wrapper modules:\n- deleted `crates/beads-rs/src/daemon/{store_lock,store_runtime}.rs`\n- internal imports retargeted to `crate::daemon::store::{lock,runtime}`\n- daemon top-level now explicitly re-exports stable lock/runtime boundary types\n\n4) Tightened visibility:\n- `crates/beads-rs/src/daemon/ipc/mod.rs` changed `ResponseExt` export to `pub(crate)`\n\n5) Removed migrate compatibility shim layer:\n- deleted `crates/beads-rs/src/migrate/mod.rs`\n- CLI migrate command now calls `beads_cli::migrate::import_go_export` directly\n\nValidation:\n- cargo check -p beads-rs\n- cargo check --workspace\n- cargo test -p beads-rs --test integration -- repl::ack::\n- cargo test -p beads-rs --test integration -- daemon::store_lock::\n- cargo test -p beads-rs --test integration --features slow-tests -- daemon::lifecycle:: (8 pass)\n- just dylint\nAll green.","author":"darin@darins-Mac-Studio-2.local","at":[1770511080398,0]},"lineage_created_at":[1770498238921,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.27","note":{"id":"legacy-notes","content":"Started .27 cleanup with low-risk shim removals plus file-level dependency audit. Landed: (1) removed beads-daemon crate compatibility alias `mod daemon { pub use crate::metrics; }` by rewriting admission.rs to import `crate::metrics` directly, and (2) removed CLI daemon command type re-export shim by switching command enum/dispatch to `beads_cli::commands::daemon::DaemonCmd` directly (daemon.rs now only renders daemon info text). Validation: cargo check -p beads-daemon, cargo check -p beads-rs, cargo test -p beads-rs --test integration -- cli::critical_path:: (6 pass), just dylint all pass. Remaining .27 work is larger import-retargeting for daemon/cli shim modules with active consumers.\n\nProgress: removed additional temporary shim layers.\n- Deleted beads-rs CLI shim files: `src/cli/parsers.rs`, `src/cli/filters.rs`, `src/cli/validation.rs` after retargeting all CLI command imports.\n- Removed CLI daemon command type re-export shim usage by switching command typing/dispatch to `beads_cli::commands::daemon::DaemonCmd` directly.\n- Removed beads-daemon crate compatibility alias `mod daemon { pub use crate::metrics; }` and imported `crate::metrics` directly in compiled module(s).\nNo compile/test regressions in verification set.\nValidation: cargo check -p beads-rs, cargo check -p beads-daemon, cargo test -p beads-rs --test integration -- cli::critical_path:: (6 pass), just dylint, cargo check --workspace.\n\nCompleted a major .27 cleanup pass removing additional temporary boundary shims and tightening visibility:\n\n1) Removed daemon wrapper modules in beads-rs and retargeted all callsites (src + tests) to owning crates:\n- deleted `crates/beads-rs/src/daemon/{admission,broadcast,clock,git_lane,remote,scheduler}.rs`\n- imports now use `beads_daemon::{admission,broadcast,clock,git_lane,remote,scheduler}` directly\n\n2) Removed temporary repl frame/proto module wrappers and retargeted callsites:\n- deleted `crates/beads-rs/src/daemon/repl/{frame,proto}.rs`\n- `repl/mod.rs` now re-exports frame/proto types/functions directly from `beads_daemon_core::repl::{frame,proto}`\n- internal/tests updated to consume owning module paths\n\n3) Removed temporary store wrapper modules:\n- deleted `crates/beads-rs/src/daemon/{store_lock,store_runtime}.rs`\n- internal imports retargeted to `crate::daemon::store::{lock,runtime}`\n- daemon top-level now explicitly re-exports stable lock/runtime boundary types\n\n4) Tightened visibility:\n- `crates/beads-rs/src/daemon/ipc/mod.rs` changed `ResponseExt` export to `pub(crate)`\n\n5) Removed migrate compatibility shim layer:\n- deleted `crates/beads-rs/src/migrate/mod.rs`\n- CLI migrate command now calls `beads_cli::migrate::import_go_export` directly\n\nValidation:\n- cargo check -p beads-rs\n- cargo check --workspace\n- cargo test -p beads-rs --test integration -- repl::ack::\n- cargo test -p beads-rs --test integration -- daemon::store_lock::\n- cargo test -p beads-rs --test integration --features slow-tests -- daemon::lifecycle:: (8 pass)\n- just dylint\nAll green.","author":"darin@darinsmcstudio2.lan","at":[1770511093702,0]},"lineage_created_at":[1770498238921,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.28","note":{"id":"go-comment-bd-21eg.28-1","content":"Closeout evidence for bd-21eg.28:\n\nDocumentation updated for final crate split + boundaries:\n- `docs/CRATE_DAG.md`\n- `docs/architecture/boundary-api-migration-matrix.md`\n- `docs/architecture/phase2-crate-split-closeout.md`\n\nBoundary / epic acceptance proof points:\n- No CLI->daemon direct imports remain (`rg -n \"crate::daemon::\" crates/beads-rs/src/cli crates/beads-cli/src` => no matches).\n- `beads-cli` and `beads-daemon` compile in workspace flows.\n- Boundary lint is active and passing (`just dylint`).\n- Surface/API contract boundary remains typed and single-source through `beads-surface`/`beads-api` interfaces.\n\nFull verification matrix run and passing:\n- `cargo check`\n- `cargo fmt --all`\n- `just dylint`\n- `cargo clippy --all-features -- -D warnings`\n- `cargo test`\n- `RUST_TEST_THREADS=1 cargo test --features slow-tests`\n\nAcceptance mapping:\n- [x] Docs updated for final crate layout\n- [x] Full verification commands pass\n- [x] Epic acceptance checklist demonstrably satisfied","author":"darin@darins-Mac-Studio-2.local","at":[1770519281463,0]},"lineage_created_at":[1770498239220,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.28","note":{"id":"legacy-notes","content":"Closeout evidence for bd-21eg.28:\n\nDocumentation updated for final crate split + boundaries:\n- `docs/CRATE_DAG.md`\n- `docs/architecture/boundary-api-migration-matrix.md`\n- `docs/architecture/phase2-crate-split-closeout.md`\n\nBoundary / epic acceptance proof points:\n- No CLI->daemon direct imports remain (`rg -n \"crate::daemon::\" crates/beads-rs/src/cli crates/beads-cli/src` => no matches).\n- `beads-cli` and `beads-daemon` compile in workspace flows.\n- Boundary lint is active and passing (`just dylint`).\n- Surface/API contract boundary remains typed and single-source through `beads-surface`/`beads-api` interfaces.\n\nFull verification matrix run and passing:\n- `cargo check`\n- `cargo fmt --all`\n- `just dylint`\n- `cargo clippy --all-features -- -D warnings`\n- `cargo test`\n- `RUST_TEST_THREADS=1 cargo test --features slow-tests`\n\nAcceptance mapping:\n- [x] Docs updated for final crate layout\n- [x] Full verification commands pass\n- [x] Epic acceptance checklist demonstrably satisfied","author":"darin@darinsmcstudio2.lan","at":[1770519281682,0]},"lineage_created_at":[1770498239220,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.32","note":{"id":"go-comment-bd-21eg.32-1","content":"Progress: root error wiring now imports IpcError from beads_surface path instead of daemon path, and root OpError export tightened to daemon::ops::OpError. Full decouple of OpError from daemon internals remains pending and will require a dedicated shared op-error surface.","author":"darin@darins-Mac-Studio-2.local","at":[1770504565841,0]},"lineage_created_at":[1770498508957,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.32","note":{"id":"legacy-notes","content":"Progress: root error wiring now imports IpcError from beads_surface path instead of daemon path, and root OpError export tightened to daemon::ops::OpError. Full decouple of OpError from daemon internals remains pending and will require a dedicated shared op-error surface.","author":"darin@darinsmcstudio2.lan","at":[1770505125849,0]},"lineage_created_at":[1770498508957,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.33","note":{"id":"go-comment-bd-21eg.33-1","content":"Implemented mutation fixture boundary decoupling from daemon internals.\nChanges:\n- `tests/integration/fixtures/mutation.rs` no longer imports `beads_rs::daemon::mutation_engine` or `beads_rs::daemon::ops::OpError`.\n- Added fixture-local typed `MutationContext` and deterministic request-hash helper based on typed context+payload digest.\nValidation:\n- cargo test -p beads-rs --test integration -- wal::idempotency:: (2 pass)\n- cargo check -p beads-rs\nAcceptance met: mutation fixture no longer imports daemon internals; idempotency behavior tests remain green.","author":"darin@darins-Mac-Studio-2.local","at":[1770509493521,0]},"lineage_created_at":[1770508423949,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.33","note":{"id":"legacy-notes","content":"Implemented mutation fixture boundary decoupling from daemon internals.\nChanges:\n- `tests/integration/fixtures/mutation.rs` no longer imports `beads_rs::daemon::mutation_engine` or `beads_rs::daemon::ops::OpError`.\n- Added fixture-local typed `MutationContext` and deterministic request-hash helper based on typed context+payload digest.\nValidation:\n- cargo test -p beads-rs --test integration -- wal::idempotency:: (2 pass)\n- cargo check -p beads-rs\nAcceptance met: mutation fixture no longer imports daemon internals; idempotency behavior tests remain green.","author":"darin@darinsmcstudio2.lan","at":[1770509493521,0]},"lineage_created_at":[1770508423949,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.34","note":{"id":"go-comment-bd-21eg.34-1","content":"Implemented store-lock fixture boundary decoupling from daemon::store_lock internals.\nChanges:\n- `tests/integration/fixtures/store_lock.rs` now uses public path APIs (`paths::store_lock_path` + data-dir override) and local typed error enum.\n- Removed direct `beads_rs::daemon::store_lock::{...}` imports.\nValidation:\n- cargo test -p beads-rs --test integration --features slow-tests -- daemon::lifecycle:: (8 pass)\n- cargo test -p beads-rs --test integration --features slow-tests -- daemon::crash_recovery:: --test-threads=1 (2 pass)\n- cargo check -p beads-rs\nAcceptance met: fixtures no longer import daemon::store_lock internals and relevant daemon/store-lock flows pass.","author":"darin@darins-Mac-Studio-2.local","at":[1770509493549,0]},"lineage_created_at":[1770508423983,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.34","note":{"id":"legacy-notes","content":"Implemented store-lock fixture boundary decoupling from daemon::store_lock internals.\nChanges:\n- `tests/integration/fixtures/store_lock.rs` now uses public path APIs (`paths::store_lock_path` + data-dir override) and local typed error enum.\n- Removed direct `beads_rs::daemon::store_lock::{...}` imports.\nValidation:\n- cargo test -p beads-rs --test integration --features slow-tests -- daemon::lifecycle:: (8 pass)\n- cargo test -p beads-rs --test integration --features slow-tests -- daemon::crash_recovery:: --test-threads=1 (2 pass)\n- cargo check -p beads-rs\nAcceptance met: fixtures no longer import daemon::store_lock internals and relevant daemon/store-lock flows pass.","author":"darin@darinsmcstudio2.lan","at":[1770509493549,0]},"lineage_created_at":[1770508423983,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.35","note":{"id":"go-comment-bd-21eg.35-1","content":"Implemented repl fixture boundary API and removed direct daemon internal imports from repl fixtures.\nChanges:\n- Added `tests/integration/fixtures/daemon_boundary.rs` with typed repl boundary exports.\n- Rewired `tests/integration/fixtures/repl_peer.rs` to import repl/admission/session types via fixture boundary module.\nValidation:\n- cargo test -p beads-rs --test integration -- repl:: (9 pass)\n- cargo check -p beads-rs\nAcceptance met: repl fixtures avoid direct daemon session/admission imports; repl integration suite remains green.","author":"darin@darins-Mac-Studio-2.local","at":[1770509501726,0]},"lineage_created_at":[1770508424013,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.35","note":{"id":"legacy-notes","content":"Implemented repl fixture boundary API and removed direct daemon internal imports from repl fixtures.\nChanges:\n- Added `tests/integration/fixtures/daemon_boundary.rs` with typed repl boundary exports.\n- Rewired `tests/integration/fixtures/repl_peer.rs` to import repl/admission/session types via fixture boundary module.\nValidation:\n- cargo test -p beads-rs --test integration -- repl:: (9 pass)\n- cargo check -p beads-rs\nAcceptance met: repl fixtures avoid direct daemon session/admission imports; repl integration suite remains green.","author":"darin@darinsmcstudio2.lan","at":[1770509501726,0]},"lineage_created_at":[1770508424013,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.36","note":{"id":"go-comment-bd-21eg.36-1","content":"Implemented WAL fixture boundary API and removed direct daemon::wal imports from targeted fixtures.\nChanges:\n- Added `tests/integration/fixtures/daemon_boundary.rs` with typed wal boundary exports.\n- Rewired `tests/integration/fixtures/wal.rs`, `wal_corrupt.rs`, and `repl_rig.rs` to import wal types/constants/functions via boundary module.\nValidation:\n- cargo test -p beads-rs --test integration -- wal:: (22 pass)\n- cargo test -p beads-rs --test integration -- repl:: (9 pass)\n- cargo check -p beads-rs\nAcceptance met: fixtures compile without direct `beads_rs::daemon::wal` imports and wal/repl slices stay green.","author":"darin@darins-Mac-Studio-2.local","at":[1770509501698,0]},"lineage_created_at":[1770508424038,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.36","note":{"id":"legacy-notes","content":"Implemented WAL fixture boundary API and removed direct daemon::wal imports from targeted fixtures.\nChanges:\n- Added `tests/integration/fixtures/daemon_boundary.rs` with typed wal boundary exports.\n- Rewired `tests/integration/fixtures/wal.rs`, `wal_corrupt.rs`, and `repl_rig.rs` to import wal types/constants/functions via boundary module.\nValidation:\n- cargo test -p beads-rs --test integration -- wal:: (22 pass)\n- cargo test -p beads-rs --test integration -- repl:: (9 pass)\n- cargo check -p beads-rs\nAcceptance met: fixtures compile without direct `beads_rs::daemon::wal` imports and wal/repl slices stay green.","author":"darin@darinsmcstudio2.lan","at":[1770509501698,0]},"lineage_created_at":[1770508424038,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.37","note":{"id":"go-comment-bd-21eg.37-1","content":"Completed extraction of typed CLI runtime primitives into beads-cli and integrated them into beads-rs without behavior changes.\n\nImplemented in beads-cli:\n- `crates/beads-cli/src/runtime.rs`\n  - `CliRuntimeCtx` (typed context struct for command handlers)\n  - transport helpers (`send_raw`, `send`)\n  - actor/description validation helpers (`validate_actor_id`, `current_actor_id`, `resolve_description`)\n- `crates/beads-cli/src/render.rs`\n  - shared render/print primitives and typed renderer trait surface\n- exports/wiring:\n  - `crates/beads-cli/src/lib.rs` exports `runtime` and `render`\n  - `crates/beads-cli/Cargo.toml` includes required typed deps (`beads-api`, `tracing`, `whoami`)\n\nIntegrated in beads-rs CLI:\n- `crates/beads-rs/src/cli/mod.rs`\n  - `Ctx` now aliases `beads_cli::runtime::CliRuntimeCtx`\n  - `resolve_description` and actor validation now delegate to beads-cli runtime helpers\n  - `send_raw`/`send` now delegate to beads-cli runtime transport helpers\n  - removed stale local transport connection implementation from beads-rs cli module\n\nValidation:\n- cargo check -p beads-cli\n- cargo check -p beads-rs\n- cargo test -p beads-rs --test integration -- cli::critical_path:: (6 pass)\n- just dylint\nAll green.","author":"darin@darins-Mac-Studio-2.local","at":[1770511730493,0]},"lineage_created_at":[1770511139193,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.37","note":{"id":"legacy-notes","content":"Completed extraction of typed CLI runtime primitives into beads-cli and integrated them into beads-rs without behavior changes.\n\nImplemented in beads-cli:\n- `crates/beads-cli/src/runtime.rs`\n  - `CliRuntimeCtx` (typed context struct for command handlers)\n  - transport helpers (`send_raw`, `send`)\n  - actor/description validation helpers (`validate_actor_id`, `current_actor_id`, `resolve_description`)\n- `crates/beads-cli/src/render.rs`\n  - shared render/print primitives and typed renderer trait surface\n- exports/wiring:\n  - `crates/beads-cli/src/lib.rs` exports `runtime` and `render`\n  - `crates/beads-cli/Cargo.toml` includes required typed deps (`beads-api`, `tracing`, `whoami`)\n\nIntegrated in beads-rs CLI:\n- `crates/beads-rs/src/cli/mod.rs`\n  - `Ctx` now aliases `beads_cli::runtime::CliRuntimeCtx`\n  - `resolve_description` and actor validation now delegate to beads-cli runtime helpers\n  - `send_raw`/`send` now delegate to beads-cli runtime transport helpers\n  - removed stale local transport connection implementation from beads-rs cli module\n\nValidation:\n- cargo check -p beads-cli\n- cargo check -p beads-rs\n- cargo test -p beads-rs --test integration -- cli::critical_path:: (6 pass)\n- just dylint\nAll green.","author":"darin@darinsmcstudio2.lan","at":[1770511736778,0]},"lineage_created_at":[1770511139193,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.38","note":{"id":"go-comment-bd-21eg.38-1","content":"Phase-1 progress landed and stabilized (compile + tests green):\n\nAdded new beads-cli read-only handler modules:\n- `crates/beads-cli/src/commands/{common,list,search,blocked,ready,stale,count}.rs`\n- `crates/beads-cli/src/commands/mod.rs` now defines typed `CommandError` and shared `print_ok`\n\nCurrent status:\n- handler implementations exist under beads-cli for the read-only pure-IPC slice\n- beads-rs dispatch rewiring to these moved handlers is NOT complete yet (next step in this bead)\n- no behavior changes introduced in active CLI path yet\n\nValidation after stabilizing worker partial state:\n- cargo check -p beads-cli\n- cargo check -p beads-rs\n- cargo test -p beads-rs --test integration -- cli::critical_path:: (6 pass)\n- just dylint\nAll green.","author":"darin@darins-Mac-Studio-2.local","at":[1770512272430,0]},"lineage_created_at":[1770511146352,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.38","note":{"id":"go-comment-bd-21eg.38-2","content":"Phase-1 read-only handler migration completed and wired.\n\nMoved/owned implementations in beads-cli:\n- `crates/beads-cli/src/commands/{list,search,blocked,ready,stale,count}.rs`\n- shared command scaffolding in `crates/beads-cli/src/commands/{mod,common}.rs`\n\nbeads-rs dispatch now uses beads-cli implementations for this subset:\n- `crates/beads-rs/src/cli/commands/{list,search,blocked,ready,stale,count}.rs`\n  now delegate to corresponding beads-cli handlers and re-export moved arg/render types\n- added typed conversion `impl From<beads_cli::commands::CommandError> for crate::Error`\n  in `crates/beads-rs/src/error.rs`\n\nResult:\n- read-only pure IPC path for these commands now executes via beads-cli-owned handler logic\n- behavior preserved (critical path remains green)\n\nValidation:\n- cargo check -p beads-cli\n- cargo check -p beads-rs\n- cargo test -p beads-rs --test integration -- cli::critical_path:: (6 pass)\n- just dylint\nAll green.","author":"darin@darins-Mac-Studio-2.local","at":[1770512413227,0]},"lineage_created_at":[1770511146352,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.38","note":{"id":"legacy-notes","content":"Phase-1 progress landed and stabilized (compile + tests green):\n\nAdded new beads-cli read-only handler modules:\n- `crates/beads-cli/src/commands/{common,list,search,blocked,ready,stale,count}.rs`\n- `crates/beads-cli/src/commands/mod.rs` now defines typed `CommandError` and shared `print_ok`\n\nCurrent status:\n- handler implementations exist under beads-cli for the read-only pure-IPC slice\n- beads-rs dispatch rewiring to these moved handlers is NOT complete yet (next step in this bead)\n- no behavior changes introduced in active CLI path yet\n\nValidation after stabilizing worker partial state:\n- cargo check -p beads-cli\n- cargo check -p beads-rs\n- cargo test -p beads-rs --test integration -- cli::critical_path:: (6 pass)\n- just dylint\nAll green.\n\nPhase-1 read-only handler migration completed and wired.\n\nMoved/owned implementations in beads-cli:\n- `crates/beads-cli/src/commands/{list,search,blocked,ready,stale,count}.rs`\n- shared command scaffolding in `crates/beads-cli/src/commands/{mod,common}.rs`\n\nbeads-rs dispatch now uses beads-cli implementations for this subset:\n- `crates/beads-rs/src/cli/commands/{list,search,blocked,ready,stale,count}.rs`\n  now delegate to corresponding beads-cli handlers and re-export moved arg/render types\n- added typed conversion `impl From<beads_cli::commands::CommandError> for crate::Error`\n  in `crates/beads-rs/src/error.rs`\n\nResult:\n- read-only pure IPC path for these commands now executes via beads-cli-owned handler logic\n- behavior preserved (critical path remains green)\n\nValidation:\n- cargo check -p beads-cli\n- cargo check -p beads-rs\n- cargo test -p beads-rs --test integration -- cli::critical_path:: (6 pass)\n- just dylint\nAll green.","author":"darin@darinsmcstudio2.lan","at":[1770512418549,0]},"lineage_created_at":[1770511146352,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.39","note":{"id":"go-comment-bd-21eg.39-1","content":"Completed: added typed host backend seam in beads-cli and implemented in beads-rs with no behavior change. Added crates/beads-cli/src/backend.rs (CliHostBackend + typed request/response types), crates/beads-rs/src/cli/backend.rs impl, injected backend into CLI context, and rewired upgrade/store/migrate handlers to use trait calls. Validation: cargo check -p beads-cli; cargo check -p beads-rs; cargo check --workspace.","author":"darin@darins-Mac-Studio-2.local","at":[1770514338751,0]},"lineage_created_at":[1770511153230,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.39","note":{"id":"legacy-notes","content":"Completed: added typed host backend seam in beads-cli and implemented in beads-rs with no behavior change. Added crates/beads-cli/src/backend.rs (CliHostBackend + typed request/response types), crates/beads-rs/src/cli/backend.rs impl, injected backend into CLI context, and rewired upgrade/store/migrate handlers to use trait calls. Validation: cargo check -p beads-cli; cargo check -p beads-rs; cargo check --workspace.","author":"darin@darinsmcstudio2.lan","at":[1770514338980,0]},"lineage_created_at":[1770511153230,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.40","note":{"id":"go-comment-bd-21eg.40-1","content":"Completed wrapper-finalization pass: removed dual ownership for migrated read-only command handlers by deleting beads-rs wrappers (list/search/ready/blocked/stale/count), routing dispatch directly to beads-cli handlers, and updating render_query to beads-cli render helpers. Kept behavior unchanged (same underlying handlers/arg types). Validation: cargo check -p beads-rs; cargo test -p beads-rs --test integration -- cli::critical_path:: (6/6 pass).","author":"darin@darins-Mac-Studio-2.local","at":[1770514339188,0]},"lineage_created_at":[1770511160065,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-21eg.40","note":{"id":"legacy-notes","content":"Completed wrapper-finalization pass: removed dual ownership for migrated read-only command handlers by deleting beads-rs wrappers (list/search/ready/blocked/stale/count), routing dispatch directly to beads-cli handlers, and updating render_query to beads-cli render helpers. Kept behavior unchanged (same underlying handlers/arg types). Validation: cargo check -p beads-rs; cargo test -p beads-rs --test integration -- cli::critical_path:: (6/6 pass).","author":"darin@darinsmcstudio2.lan","at":[1770514339394,0]},"lineage_created_at":[1770511160065,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-34oa","note":{"id":"go-comment-bd-34oa-1","content":"Reminder: rendering should stay in command files; avoid moving rendering into shared helpers.","author":"darin@darins-Mac-Studio-2.local","at":[1769572811156,0]},"lineage_created_at":[1769563878222,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-34oa","note":{"id":"legacy-notes","content":"Reminder: rendering should stay in command files; avoid moving rendering into shared helpers.","author":"darin@darinsmcstudio2.lan","at":[1769574790928,0]},"lineage_created_at":[1769563878222,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-34px","note":{"id":"go-comment-bd-34px-1","content":"Rendering should remain in command files; avoid extracting rendering into shared helpers.","author":"darin@darins-Mac-Studio-2.local","at":[1769580773613,0]},"lineage_created_at":[1769494178400,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-34px","note":{"id":"legacy-notes","content":"Rendering should remain in command files; avoid extracting rendering into shared helpers.","author":"darin@darinsmcstudio2.lan","at":[1769581825097,0]},"lineage_created_at":[1769494178400,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-3m5.43","note":{"id":"go-comment-bd-3m5.43-1","content":"Implemented Limits struct + defaults, config plumbing, IPC frame limit, WAL record size guard, and note/label limits with tests. Remaining for later phases: EventBody CBOR decode limits and replication frame/batch enforcement once those modules land.","author":"darin@darinsmacstudio.lan","at":[1768189215964,0]},"lineage_created_at":[1768178909582,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-3m5.43","note":{"id":"legacy-notes","content":"Implemented Limits struct + defaults, config plumbing, IPC frame limit, WAL record size guard, and note/label limits with tests. Remaining for later phases: EventBody CBOR decode limits and replication frame/batch enforcement once those modules land.","author":"darin@darinsmcstudio2.lan","at":[1768282020116,0]},"lineage_created_at":[1768178909582,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-3m5.99","note":{"id":"go-comment-bd-3m5.99-1","content":"Env var audit: map to config where appropriate. Recommend: BD_ACTOR -> defaults.actor (env remains override); BD_REPL_LISTEN_ADDR -> replication.listen_addr; BD_REPL_MAX_CONNECTIONS -> replication.max_connections; BD_LOAD_TIMEOUT_SECS -> timeouts.git_load_secs (or similar). Keep env-only: BD_REMOTE_URL, BD_STORE_ID (debug overrides); BD_DATA_DIR/BD_CONFIG_DIR/BD_WAL_DIR; LOG; BD_NO_AUTO_UPGRADE (override); BD_UPGRADE_* (test/upgrade harness); BD_TEST_WAL_HANG_* (slow-tests). BD_TOMBSTONE_TTL_MS is legacy tombstone GC for git sync; leave env-only or add to a legacy config section if we intentionally support it.","author":"darin@book","at":[1768449533383,0]},"lineage_created_at":[1768448649899,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-3m5.99","note":{"id":"legacy-notes","content":"Env var audit: map to config where appropriate. Recommend: BD_ACTOR -> defaults.actor (env remains override); BD_REPL_LISTEN_ADDR -> replication.listen_addr; BD_REPL_MAX_CONNECTIONS -> replication.max_connections; BD_LOAD_TIMEOUT_SECS -> timeouts.git_load_secs (or similar). Keep env-only: BD_REMOTE_URL, BD_STORE_ID (debug overrides); BD_DATA_DIR/BD_CONFIG_DIR/BD_WAL_DIR; LOG; BD_NO_AUTO_UPGRADE (override); BD_UPGRADE_* (test/upgrade harness); BD_TEST_WAL_HANG_* (slow-tests). BD_TOMBSTONE_TTL_MS is legacy tombstone GC for git sync; leave env-only or add to a legacy config section if we intentionally support it.","author":"darin@darinsmcstudio2.lan","at":[1768487268821,0]},"lineage_created_at":[1768448649899,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-5cay","note":{"id":"go-comment-bd-5cay-1","content":"Notes from papers:\n\n- iMocket: incremental model-checking-guided testing. Model checker generates traces for tests; when the model changes, only affected states are re-tested via incremental testing patterns. Uses a growth-based graph traversal algorithm to identify affected states and minimize the required tests compared to full re-checking.\n\n- ER-: exhaustive interleaving replay for replicated libraries. Workflow: instrument Start/End around the code segment; proxy intercepts library calls to extract operations + events; generate interleavings, reset replicas between runs, and enforce a chosen interleaving via a distributed lock. Pruning techniques include event grouping, replica-specific pruning, event-independence pruning, and skipping failed ops.\n\nChosen mechanisms to implement now:\n- Intercept replication frames via tailnet proxy, record the observed interleaving order, and replay deterministically.\n- Deterministic replay enforcement with a strict order (fails if the run diverges).\n- Keep trace files per link under ./tmp; integrate in a slow e2e test.","author":"darin@book","at":[1768726414980,0]},"lineage_created_at":[1768673120786,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-5cay","note":{"id":"legacy-notes","content":"Notes from papers:\n\n- iMocket: incremental model-checking-guided testing. Model checker generates traces for tests; when the model changes, only affected states are re-tested via incremental testing patterns. Uses a growth-based graph traversal algorithm to identify affected states and minimize the required tests compared to full re-checking.\n\n- ER-: exhaustive interleaving replay for replicated libraries. Workflow: instrument Start/End around the code segment; proxy intercepts library calls to extract operations + events; generate interleavings, reset replicas between runs, and enforce a chosen interleaving via a distributed lock. Pruning techniques include event grouping, replica-specific pruning, event-independence pruning, and skipping failed ops.\n\nChosen mechanisms to implement now:\n- Intercept replication frames via tailnet proxy, record the observed interleaving order, and replay deterministically.\n- Deterministic replay enforcement with a strict order (fails if the run diverges).\n- Keep trace files per link under ./tmp; integrate in a slow e2e test.","author":"darin@darinsmcstudio2.lan","at":[1768726624161,0]},"lineage_created_at":[1768673120786,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-8ezy","note":{"id":"go-comment-bd-8ezy-1","content":"Constraint: keep rendering in command files; do not centralize or move rendering logic out of command handlers.","author":"darin@darins-Mac-Studio-2.local","at":[1769587294121,0]},"lineage_created_at":[1769563852300,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-8ezy","note":{"id":"legacy-notes","content":"Constraint: keep rendering in command files; do not centralize or move rendering logic out of command handlers.","author":"darin@darinsmcstudio2.lan","at":[1769587543355,0]},"lineage_created_at":[1769563852300,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-8xkm","note":{"id":"go-comment-bd-8xkm-1","content":"Note: if any rendering is touched, keep rendering in the command files; do not centralize rendering elsewhere.","author":"darin@darins-Mac-Studio-2.local","at":[1769599203862,0]},"lineage_created_at":[1769573215365,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-8xkm","note":{"id":"legacy-notes","content":"Note: if any rendering is touched, keep rendering in the command files; do not centralize rendering elsewhere.","author":"darin@darinsmcstudio2.lan","at":[1769626630601,0]},"lineage_created_at":[1769573215365,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-8yac","note":{"id":"go-comment-bd-8yac-1","content":"Rendering stays in command files; do not move render logic out during this refactor.","author":"darin@darins-Mac-Studio-2.local","at":[1769575908535,0]},"lineage_created_at":[1769573131220,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-8yac","note":{"id":"legacy-notes","content":"Rendering stays in command files; do not move render logic out during this refactor.","author":"darin@darinsmcstudio2.lan","at":[1769577417122,0]},"lineage_created_at":[1769573131220,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-907g","note":{"id":"go-comment-bd-907g-1","content":"Rendering should remain in command files; avoid centralizing CLI rendering while refactoring validation boundaries.","author":"darin@darins-Mac-Studio-2.local","at":[1769596252802,0]},"lineage_created_at":[1769573175272,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-907g","note":{"id":"legacy-notes","content":"Rendering should remain in command files; avoid centralizing CLI rendering while refactoring validation boundaries.","author":"darin@darinsmcstudio2.lan","at":[1769597435084,0]},"lineage_created_at":[1769573175272,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-fn5l","note":{"id":"go-comment-bd-fn5l-1","content":"Rendering stays in command files; avoid moving output logic into shared render modules for this work.","author":"darin@darins-Mac-Studio-2.local","at":[1769594432634,0]},"lineage_created_at":[1769573201177,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-fn5l","note":{"id":"legacy-notes","content":"Rendering stays in command files; avoid moving output logic into shared render modules for this work.","author":"darin@darinsmcstudio2.lan","at":[1769595404044,0]},"lineage_created_at":[1769573201177,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-lcyk","note":{"id":"go-comment-bd-lcyk-1","content":"Rendering should remain in the command files; avoid moving rendering into shared helpers.","author":"darin@darins-Mac-Studio-2.local","at":[1769585373941,0]},"lineage_created_at":[1769563157376,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-lcyk","note":{"id":"legacy-notes","content":"Rendering should remain in the command files; avoid moving rendering into shared helpers.","author":"darin@darinsmcstudio2.lan","at":[1769586008771,0]},"lineage_created_at":[1769563157376,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-oybi","note":{"id":"go-comment-bd-oybi-1","content":"Rendering should stay in command files; avoid centralizing output rendering in shared helpers.","author":"darin@darins-Mac-Studio-2.local","at":[1769589301774,0]},"lineage_created_at":[1769573146615,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-oybi","note":{"id":"legacy-notes","content":"Rendering should stay in command files; avoid centralizing output rendering in shared helpers.","author":"darin@darinsmcstudio2.lan","at":[1769590164941,0]},"lineage_created_at":[1769573146615,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-rzh4","note":{"id":"go-comment-bd-rzh4-1","content":"Implemented via FrameLimitState (Arc<AtomicUsize>) with NegotiatedFrameLimit newtype; reader loops apply negotiated limit after handshake so FrameReader enforces it per frame.","author":"darin@darins-Mac-Studio-2.local","at":[1769569095172,0]},"lineage_created_at":[1769563141180,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-rzh4","note":{"id":"legacy-notes","content":"Implemented via FrameLimitState (Arc<AtomicUsize>) with NegotiatedFrameLimit newtype; reader loops apply negotiated limit after handshake so FrameReader enforces it per frame.","author":"darin@darinsmcstudio2.lan","at":[1769569161254,0]},"lineage_created_at":[1769563141180,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-t9xz","note":{"id":"go-comment-bd-t9xz-1","content":"Reminder: keep rendering in the command files themselves; avoid moving rendering into shared layers.","author":"darin@darins-Mac-Studio-2.local","at":[1769590759150,0]},"lineage_created_at":[1769573160970,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-t9xz","note":{"id":"legacy-notes","content":"Reminder: keep rendering in the command files themselves; avoid moving rendering into shared layers.","author":"darin@darinsmcstudio2.lan","at":[1769593331247,0]},"lineage_created_at":[1769573160970,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-uzwo","note":{"id":"go-comment-bd-uzwo-1","content":"Rendering stays in command files; helper should only reduce validation error boilerplate.","author":"darin@darins-Mac-Studio-2.local","at":[1769579440594,0]},"lineage_created_at":[1769309224115,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-uzwo","note":{"id":"legacy-notes","content":"Rendering stays in command files; helper should only reduce validation error boilerplate.","author":"darin@darinsmcstudio2.lan","at":[1769579564772,0]},"lineage_created_at":[1769309224115,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-v1xr","note":{"id":"go-comment-bd-v1xr-1","content":"Constraint: keep rendering logic in the command files themselves; do not move rendering out of command files.","author":"darin@darins-Mac-Studio-2.local","at":[1769583969449,0]},"lineage_created_at":[1769501256172,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-v1xr","note":{"id":"legacy-notes","content":"Constraint: keep rendering logic in the command files themselves; do not move rendering out of command files.","author":"darin@darinsmcstudio2.lan","at":[1769584529017,0]},"lineage_created_at":[1769501256172,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-wxaq","note":{"id":"go-comment-bd-wxaq-1","content":"Rendering should stay in the command files themselves; do not move rendering into shared helpers.","author":"darin@darins-Mac-Studio-2.local","at":[1769570923199,0]},"lineage_created_at":[1769563839480,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-wxaq","note":{"id":"legacy-notes","content":"Rendering should stay in the command files themselves; do not move rendering into shared helpers.","author":"darin@darinsmcstudio2.lan","at":[1769571514034,0]},"lineage_created_at":[1769563839480,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-x4zj","note":{"id":"go-comment-bd-x4zj-1","content":"Per user: keep rendering helpers in the command files; avoid central render.rs. Replace println! with local render_* helpers + print_ok/print_json.","author":"darin@darins-Mac-Studio-2.local","at":[1769562626979,0]},"lineage_created_at":[1769309222772,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-x4zj","note":{"id":"go-comment-bd-x4zj-2","content":"Per user: keep rendering helpers in the command files; avoid central render.rs. Replace println! with local render_* helpers + print_ok/print_json.","author":"darin@darins-Mac-Studio-2.local","at":[1769562879544,0]},"lineage_created_at":[1769309222772,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-x4zj","note":{"id":"go-comment-bd-x4zj-3","content":"Decision: keep rendering in the command files themselves; avoid moving output into render.rs or other centralized render helpers.","author":"darin@darins-Mac-Studio-2.local","at":[1769564808968,0]},"lineage_created_at":[1769309222772,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-x4zj","note":{"id":"go-comment-bd-x4zj-4","content":"Reaffirmed: keep rendering in the command files; avoid central render.rs helpers.","author":"darin@darins-Mac-Studio-2.local","at":[1769577749197,0]},"lineage_created_at":[1769309222772,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-x4zj","note":{"id":"legacy-notes","content":"Per user: keep rendering helpers in the command files; avoid central render.rs. Replace println! with local render_* helpers + print_ok/print_json.\n\nPer user: keep rendering helpers in the command files; avoid central render.rs. Replace println! with local render_* helpers + print_ok/print_json.\n\nDecision: keep rendering in the command files themselves; avoid moving output into render.rs or other centralized render helpers.\n\nReaffirmed: keep rendering in the command files; avoid central render.rs helpers.","author":"darin@darinsmcstudio2.lan","at":[1769577749197,0]},"lineage_created_at":[1769309222772,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-znle","note":{"id":"go-comment-bd-znle-1","content":"Rendering should stay in the command files themselves (no central render move).","author":"darin@darins-Mac-Studio-2.local","at":[1769597741143,0]},"lineage_created_at":[1769565897011,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
{"bead_id":"bd-znle","note":{"id":"legacy-notes","content":"Rendering should stay in the command files themselves (no central render move).","author":"darin@darinsmcstudio2.lan","at":[1769597866832,0]},"lineage_created_at":[1769565897011,0],"lineage_created_by":"darin@darinsmcstudio2.lan"}
