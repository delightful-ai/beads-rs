{"_at":[1767992356270,0],"_by":"darin@darinsmcstudio2.lan","acceptance_criteria":"- [ ] New model file exists (e.g., beads_stateright_models/examples/checkpoint_lane_machine.rs) and compiles\n- [ ] Properties cover: truthful inclusion, import advances durable >= included, multi-writer convergence, and no cross-epoch merge (todo.md Model #4)\n- [ ] Model doc comments reference REALTIME_PLAN.md §13 and §0.12.1\n- [ ] Example runs via cargo run --example checkpoint_lane_machine (or equivalent)","assignee":"darin@darinsmacstudio.lan","created_at":[1767985311211,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nWe need a model for checkpoint correctness and convergence that reflects REALTIME_PLAN.md §13 and §0.12.1. There is no Stateright model covering included watermarks, included_heads, or multi-writer retry logic.\n\n**Design Notes**\nKeep the checkpoint data abstract (state_digest + included watermarks) but model the writer loop and import rules.","design":"**Design**\nBuild a Stateright model of the checkpoint lane: a register representing the checkpoint ref per group, multiple writers with non-FF failures, and import + merge logic. Represent each checkpoint as (state_digest, included watermarks, included_heads, store_epoch). Enforce Plan §13.9 import rules: durable watermarks advance to at least meta.included and included_heads seed head_sha (Plan §0.12.1).\n\nModel the multi-writer retry loop (Plan §13.10): fetch, import+merge, re-export, retry until push succeeds. Reject epoch mismatch (Plan §2.1 + §13.9.1).\n\nKeep JSONL/manifest/tar out of scope; this model focuses on semantic correctness (Plan §13.3-§13.9).","id":"bd-hjm.4","labels":{"cc":{"max":{}},"entries":{"modeling":[{"counter":16889135746198541417,"replica":"157e597f-a1fd-9acb-90ce-4afd2d209ecd"}],"realtime":[{"counter":9722930878531069402,"replica":"2afd0341-5da5-65b2-2fe7-2596a8404a4e"}],"stateright":[{"counter":9919912524913751886,"replica":"eae24f2b-3d3a-e4a0-3ef5-5ba7d17c57b3"}]}},"priority":2,"status":"closed","title":"Stateright: checkpoint lane correctness + multi-writer","type":"feature"}
{"_at":[1765775066747,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@dusk","created_at":[1765689969686,0],"created_by":"darin@darinsmcstudio2.lan","description":"## What's Wrong\nIf an older `bd daemon run` process is already running, a newer `bd` CLI will connect to it and may hit confusing errors when behavior/protocol expectations change (e.g. bead ID parsing rules).\n\n## Where\n- src/daemon/ipc.rs: client connects to existing socket without verifying daemon version\n- src/daemon/run.rs: daemon is spawned from current executable only when no daemon is reachable\n\n## Why It Matters\nUpgrading `bd` can silently keep using an older daemon until the socket disappears. This can break new features (like non-`bd-` id slugs) and makes failures look like user input errors.\n\n## Suggested Fix\nAdd a lightweight handshake (e.g. Request::Ping returns daemon version/build hash). If mismatch with client, have client request shutdown + respawn, or refuse with a clear message.\n\n---\nDiscovered while: implementing beads-go migration root slug support.","id":"bd-ydi","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Daemon restart on client version mismatch","type":"chore"}
