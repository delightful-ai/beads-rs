{"_at":[1767992356270,1],"_by":"darin@darinsmacstudio.lan","_v":{"acceptance_criteria":[[1767985311211,1],"darin@darinsmacstudio.lan"],"claim":[[1767992086760,1],"darin@darinsmacstudio.lan"],"description":[[1767985311211,1],"darin@darinsmacstudio.lan"],"design":[[1767985311211,1],"darin@darinsmacstudio.lan"],"estimated_minutes":[[1767985311211,1],"darin@darinsmacstudio.lan"],"external_ref":[[1767985311211,1],"darin@darinsmacstudio.lan"],"labels":[[1767985311211,1],"darin@darinsmacstudio.lan"],"priority":[[1767985311211,1],"darin@darinsmacstudio.lan"],"source_repo":[[1767985311211,1],"darin@darinsmacstudio.lan"],"title":[[1767985311211,1],"darin@darinsmacstudio.lan"],"type":[[1767985311211,1],"darin@darinsmacstudio.lan"]},"acceptance_criteria":"- [ ] New model file exists (e.g., beads_stateright_models/examples/checkpoint_lane_machine.rs) and compiles\n- [ ] Properties cover: truthful inclusion, import advances durable >= included, multi-writer convergence, and no cross-epoch merge (todo.md Model #4)\n- [ ] Model doc comments reference REALTIME_PLAN.md §13 and §0.12.1\n- [ ] Example runs via cargo run --example checkpoint_lane_machine (or equivalent)","assignee":"darin@darinsmacstudio.lan","assignee_at":[1767992086760,1],"assignee_expires":1767995686760,"closed_at":[1767992356270,1],"closed_by":"darin@darinsmacstudio.lan","created_at":[1767985311211,1],"created_by":"darin@darinsmacstudio.lan","description":"**Problem**\nWe need a model for checkpoint correctness and convergence that reflects REALTIME_PLAN.md §13 and §0.12.1. There is no Stateright model covering included watermarks, included_heads, or multi-writer retry logic.\n\n**Design Notes**\nKeep the checkpoint data abstract (state_digest + included watermarks) but model the writer loop and import rules.","design":"**Design**\nBuild a Stateright model of the checkpoint lane: a register representing the checkpoint ref per group, multiple writers with non-FF failures, and import + merge logic. Represent each checkpoint as (state_digest, included watermarks, included_heads, store_epoch). Enforce Plan §13.9 import rules: durable watermarks advance to at least meta.included and included_heads seed head_sha (Plan §0.12.1).\n\nModel the multi-writer retry loop (Plan §13.10): fetch, import+merge, re-export, retry until push succeeds. Reject epoch mismatch (Plan §2.1 + §13.9.1).\n\nKeep JSONL/manifest/tar out of scope; this model focuses on semantic correctness (Plan §13.3-§13.9).","id":"bd-hjm.4","labels":["modeling","realtime","stateright"],"priority":2,"status":"closed","title":"Stateright: checkpoint lane correctness + multi-writer","type":"feature"}
{"_at":[1765775066747,0],"_by":"darin@dusk","_v":{"acceptance_criteria":[[1765689969686,0],"darin@dusk"],"claim":[[1765774474829,0],"darin@dusk"],"description":[[1765690062751,0],"darin@dusk"],"design":[[1765689969686,0],"darin@dusk"],"estimated_minutes":[[1765689969686,0],"darin@dusk"],"external_ref":[[1765689969686,0],"darin@dusk"],"labels":[[1765689969686,0],"darin@dusk"],"priority":[[1765689969686,0],"darin@dusk"],"source_repo":[[1765689969686,0],"darin@dusk"],"title":[[1765689969686,0],"darin@dusk"],"type":[[1765689969686,0],"darin@dusk"]},"assignee":"darin@dusk","assignee_at":[1765774474829,0],"assignee_expires":1765778074829,"closed_at":[1765775066747,0],"closed_by":"darin@dusk","created_at":[1765689969686,0],"created_by":"darin@dusk","description":"## What's Wrong\nIf an older `bd daemon run` process is already running, a newer `bd` CLI will connect to it and may hit confusing errors when behavior/protocol expectations change (e.g. bead ID parsing rules).\n\n## Where\n- src/daemon/ipc.rs: client connects to existing socket without verifying daemon version\n- src/daemon/run.rs: daemon is spawned from current executable only when no daemon is reachable\n\n## Why It Matters\nUpgrading `bd` can silently keep using an older daemon until the socket disappears. This can break new features (like non-`bd-` id slugs) and makes failures look like user input errors.\n\n## Suggested Fix\nAdd a lightweight handshake (e.g. Request::Ping returns daemon version/build hash). If mismatch with client, have client request shutdown + respawn, or refuse with a clear message.\n\n---\nDiscovered while: implementing beads-go migration root slug support.","id":"bd-ydi","labels":[],"priority":2,"status":"closed","title":"Daemon restart on client version mismatch","type":"chore"}
