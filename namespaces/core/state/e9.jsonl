{"_at":[1768282017214,1],"_by":"darin@darinsmacstudio.lan","_v":{"acceptance_criteria":[[1768178715136,1],"darin@darinsmacstudio.lan"],"claim":[[1768279443710,1],"darin@darinsmacstudio.lan"],"description":[[1768178715136,1],"darin@darinsmacstudio.lan"],"design":[[1768178715136,1],"darin@darinsmacstudio.lan"],"estimated_minutes":[[1768178715136,1],"darin@darinsmacstudio.lan"],"external_ref":[[1768178715136,1],"darin@darinsmacstudio.lan"],"labels":[[1768178715136,1],"darin@darinsmacstudio.lan"],"priority":[[1768261541990,1],"darin@darinsmacstudio.lan"],"source_repo":[[1768178715136,1],"darin@darinsmacstudio.lan"],"title":[[1768185401636,1],"darin@darinsmacstudio.lan"],"type":[[1768178715136,1],"darin@darinsmacstudio.lan"]},"assignee":"darin@darinsmacstudio.lan","assignee_at":[1768279443710,1],"assignee_expires":1768283043710,"closed_at":[1768282017214,1],"closed_by":"darin@darinsmacstudio.lan","created_at":[1768178715136,1],"created_by":"darin@darinsmacstudio.lan","description":"**Problem**\nHLC state must be persisted to prevent stamp regression after restart or wall-clock rollback. Recovery must reconstruct HLC from WAL if SQLite is missing.\n\n**Context**\n- REALTIME_PLAN.md ยง2.8 (write stamps explicit requirements)\n- ยง6.2 (hlc table in SQLite schema)\n\n**Design**\n- Add `hlc` table to SQLite schema: (actor_id TEXT PK, last_physical_ms INTEGER, last_logical INTEGER)\n- On startup: initialize HLC from max(persisted, system_time)\n- On mint: clamp forward jumps to HLC_MAX_FORWARD_DRIFT_MS (default 600s), log anomaly\n- On index rebuild: scan WAL records for hlc_max and take max per ActorId\n- Persist HLC in same critical section as WAL append/index commit\n\n**Acceptance**\n- [ ] HLC state persisted in SQLite hlc table\n- [ ] Restart recovers HLC without stamp regression\n- [ ] Forward jump clamping logged as anomaly\n- [ ] Index rebuild reconstructs HLC from WAL hlc_max\n\n**Files:** src/daemon/wal/index.rs, src/core/time.rs, src/daemon/mutation_engine.rs","id":"bd-3m5.26","labels":[],"priority":1,"status":"closed","title":"Phase 4: HLC persistence + recovery","type":"task"}
{"_at":[1768254389567,1],"_by":"darin@darinsmacstudio.lan","_v":{"acceptance_criteria":[[1768245306934,1],"darin@darinsmacstudio.lan"],"claim":[[1768245306934,1],"darin@darinsmacstudio.lan"],"description":[[1768245306934,1],"darin@darinsmacstudio.lan"],"design":[[1768245306934,1],"darin@darinsmacstudio.lan"],"estimated_minutes":[[1768245306934,1],"darin@darinsmacstudio.lan"],"external_ref":[[1768245306934,1],"darin@darinsmacstudio.lan"],"labels":[[1768245306934,1],"darin@darinsmacstudio.lan"],"priority":[[1768245306934,1],"darin@darinsmacstudio.lan"],"source_repo":[[1768245306934,1],"darin@darinsmacstudio.lan"],"title":[[1768245306934,1],"darin@darinsmacstudio.lan"],"type":[[1768245306934,1],"darin@darinsmacstudio.lan"]},"closed_at":[1768254389567,1],"closed_by":"darin@darinsmacstudio.lan","closed_reason":"empty stub - no description","created_at":[1768245306934,1],"created_by":"darin@darinsmacstudio.lan","description":"","id":"bd-97v","labels":[],"priority":2,"status":"closed","title":"Crash recovery","type":"task"}
