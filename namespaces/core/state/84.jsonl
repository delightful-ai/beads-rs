{"_at":[1768246638048,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@darinsmacstudio.lan","created_at":[1768180763865,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nPhase 3 tests need WAL segment fixtures and SQLite test helpers.\n\n**Context**\n- REALTIME_PLAN.md ยง18: WAL framing, tail truncation, index rebuild\n- Blocks Phase 3 testing bead\n\n**Design**\nCreate test infrastructure:\n- Temp WAL directory helpers (namespace subdirs, segment files)\n- Segment file fixtures: valid, corrupted (bad crc), partial (truncated mid-record)\n- SQLite test database setup/teardown\n- WAL record builders with known bytes\n- Crash simulation helpers (write partial record, kill before fsync)\n\n**Acceptance**\n- [ ] tests/fixtures/wal.rs with TempWalDir, segment file generators\n- [ ] tests/fixtures/wal_corrupt.rs with corruption injection helpers\n- [ ] Fixtures include: valid segment, bad-crc segment, truncated segment\n- [ ] cargo test fixtures::wal passes\n\n**Files:** tests/fixtures/wal.rs (new), tests/fixtures/wal_corrupt.rs (new)","id":"bd-3m5.57","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Phase 3 test infrastructure: WAL fixtures + segment helpers","type":"task"}
{"_at":[1768522037086,0],"_by":"darin@darinsmcstudio2.lan","acceptance_criteria":"- [ ] `Reject` carries a typed reason, not a string.\n- [ ] Error payloads include the mapped reason consistently.\n- [ ] Gap buffer/session tests updated.","assignee":"darin@book","created_at":[1768503245771,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\n`IngestDecision::Reject { code: String }` in `src/daemon/repl/gap_buffer.rs` uses ad-hoc string codes (\"prev_unknown\", \"gap_timeout\", \"gap_buffer_overflow\", etc.) and the session layer forwards them into `SubscriberLagged` errors. This is brittle and makes it easy to add new reasons without updating error handling.\n\n**Files**\n- src/daemon/repl/gap_buffer.rs\n- src/daemon/repl/session.rs\n- src/core/error/details.rs (if adding structured reason)","design":"Replace string codes with a typed enum (e.g., `ReplRejectReason`). Map that enum to error payloads (and, if needed, add a structured detail field for the reason). Update gap buffer + session logic and tests accordingly.","id":"bd-al7","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Repl gap buffer reject reasons should be typed","type":"chore"}
{"_at":[1768622610999,0],"_by":"darin@darinsmcstudio2.lan","created_at":[1768622610999,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nAI agents need a standard way to discover project-specific instructions, APIs, and tools. The llms.txt standard (https://llmstxt.org/) provides a well-known endpoint for agent discoverability. Beads should generate this automatically based on project state.\n\n**What the Feature Does**\nAutomatically generate `/llms.txt` (or `.beads/llms.txt`) containing:\n- Project overview from README\n- Available beads commands (bd create, bd ready, etc.)\n- Current issues and status\n- Project-specific workflows\n- Agent instructions from AGENTS.md\n- Integration points (git hooks, sync, etc.)\n\n**Example Output**:\n```\n# My Project (bd)\n\n> Git-backed issue tracker for AI workflows.\n\n## Essential Commands\n\nbd create \"Title\" -p 1 --json      # Create issue\nbd ready --json                     # Show ready work\nbd sync                             # Sync to git\n\n## Current Work (Auto-generated)\n\nOpen Issues: 12\n- bd-abc (P0): Critical bug in sync\n- bd-xyz (P1): Implement feature X\n\nReady to Work: 5 issues\nBlocked: 3 issues\n\n## Agent Workflows\n\nSee AGENTS.md for complete guide.\nAlways use --json for programmatic access.\nRun `bd sync` at end of session.\n\n## Documentation\n\n- Full docs: ./docs/\n- API: Run `bd help --json`\n```\n\n**Why It Needs Design Work**\n\n1. **Content Strategy**:\n   - What to include? Too much = noise, too little = not useful\n   - Static content (commands, docs) vs dynamic (current issues)\n   - Freshness - regenerate when? After every operation?\n   - Caching strategy?\n\n2. **Generation Model**:\n   - Option A: Generate on-demand (`bd llms-txt`)\n   - Option B: Auto-generate after mutations (create, update, close)\n   - Option C: Web server endpoint (daemon serves it)\n   - Option D: Static file committed to repo\n   - Which fits beads workflow best?\n\n3. **Content Depth**:\n   - Minimal: Just commands and project name\n   - Medium: Commands + current work summary  \n   - Full: Entire state dump (issues, deps, labels)\n   - How to balance discoverability vs overwhelming?\n\n4. **Multi-Repo Handling**:\n   - Single repo: Easy, one llms.txt\n   - Multi-repo/orchestrator: Which issues to show?\n   - Aggregate all rigs?\n   - Per-rig llms.txt?\n\n**Key Decisions to Make**\n\n1. **File Location**:\n   - Standard: `/llms.txt` in repo root (web-accessible)\n   - Beads-specific: `.beads/llms.txt`\n   - Both?\n   - User-configurable via config?\n\n2. **Generation Trigger**:\n   ```\n   Option A: Manual\n   - bd llms-txt > /llms.txt\n   - User commits to repo\n   \n   Option B: Auto-update\n   - After bd create/update/close\n   - Daemon background task\n   \n   Option C: Dynamic\n   - Daemon serves endpoint\n   - Not a file, just API\n   \n   Option D: Hybrid\n   - bd sync generates static file\n   - Always fresh after sync\n   ```\n\n3. **Content Template**:\n   ```markdown\n   # {project_name}\n   \n   > {description from README or config}\n   \n   ## Quick Start\n   {from README or QUICKSTART.md}\n   \n   ## Essential Commands\n   {list of bd commands with examples}\n   \n   ## Current State (as of {timestamp})\n   - Open: {count}\n   - Ready: {count}\n   - Blocked: {count}\n   \n   Top Priority:\n   {top 5 ready issues}\n   \n   ## Workflows\n   {from AGENTS.md if exists}\n   \n   ## Documentation\n   {links to docs, README, etc}\n   ```\n\n4. **Dynamic Content Freshness**:\n   - Include timestamp?\n   - Show staleness warning if old?\n   - Auto-regenerate on `bd sync`?\n   - Manual refresh command?\n\n**Trade-offs to Consider**\n\n1. **Static vs Dynamic**:\n   - Static: Works with any web server, git-tracked\n   - Dynamic: Always fresh, but requires daemon\n   - Hybrid: Best of both?\n\n2. **Detail Level**:\n   - Detailed: More useful for agents\n   - Minimal: Cleaner, less maintenance\n   - Solution: Configurable verbosity?\n\n3. **Performance**:\n   - Full state dump = expensive\n   - Summary = fast but less useful\n   - Cache + incremental updates?\n\n4. **Git Pollution**:\n   - Auto-generated files in commits = noisy\n   - Gitignore llms.txt and serve dynamically?\n   - Or embrace it (it's useful)?\n\n**Reference Files in Go Beads**\n- `/Users/darin/Projects/beads-rs-macstudio/tmp/beads/website/static/llms.txt` - Example output\n- Search for \"llms\" in codebase\n\n**Go Implementation** (if exists):\nCurrently Go beads has a static `website/static/llms.txt` manually maintained.\nNo auto-generation found in codebase - opportunity to pioneer!\n\n**llms.txt Standard**\nFrom https://llmstxt.org/:\n- Markdown format\n- Well-known location: `/llms.txt`\n- Designed for language models to read\n- Should be concise but comprehensive\n- Include project context, APIs, current state\n- Links to fuller documentation\n\n**Use Cases to Support**\n\n1. **Agent Onboarding**:\n   - New AI agent joins project\n   - Reads llms.txt to understand project\n   - Gets current work, commands, workflows\n\n2. **Context Refresh**:\n   - Long-running session\n   - Agent re-reads llms.txt for latest state\n   - Discovers new issues, blockers\n\n3. **Cross-Project Discovery**:\n   - Agent working on multiple projects\n   - Quickly switch context via llms.txt\n   - Consistent format across projects\n\n4. **Documentation Portal**:\n   - Web-accessible project overview\n   - Human-readable too\n   - Living documentation\n\n**Content Sections to Consider**\n\n1. **Project Metadata**:\n   - Name, description\n   - Repository URL\n   - License\n   - Key maintainers\n\n2. **Quick Start**:\n   - Installation\n   - Basic commands\n   - First steps\n\n3. **Current State**:\n   - Issue counts by status\n   - Top priority work\n   - Recent activity\n\n4. **Commands**:\n   - Essential bd commands\n   - JSON output examples\n   - Common patterns\n\n5. **Workflows**:\n   - Agent-specific instructions\n   - Session protocol\n   - Best practices\n\n6. **Documentation Links**:\n   - README\n   - AGENTS.md\n   - API docs\n   - Specs\n\n**Open Design Questions**\n\n1. Should llms.txt be versioned?\n   - Include API version, schema version?\n   - Help agents understand format changes?\n\n2. Multiple formats?\n   - llms.txt (markdown)\n   - llms.json (structured data)\n   - llms.html (pretty view)\n\n3. Privacy/security?\n   - Filter sensitive issues?\n   - Public vs private sections?\n   - Authentication for full details?\n\n4. Customization?\n   - Template system?\n   - User-provided sections?\n   - Plugin hooks to add content?\n\n5. Standard vs beads-specific?\n   - Follow llms.txt spec strictly?\n   - Or extend with beads-specific sections?\n   - Namespace extensions?\n\n**Integration Points**\n\n- `bd info --json` - Current state data\n- `bd ready --json` - Top priority work\n- `bd list --json` - All issues\n- `bd help` - Command reference\n- README.md - Project description\n- AGENTS.md - Agent workflows\n- CLAUDE.md - Agent instructions\n\n**Acceptance**\n- [ ] Design document for llms.txt generation\n- [ ] Content template and structure\n- [ ] Generation trigger strategy (manual, auto, dynamic)\n- [ ] File location(s) decision\n- [ ] Dynamic content freshness approach\n- [ ] Multi-repo handling\n- [ ] Privacy/filtering rules\n- [ ] Performance considerations\n- [ ] Integration with bd sync workflow\n- [ ] Template customization mechanism\n- [ ] Example output for beads-rs itself","id":"bd-ze0x.52","labels":{"cc":{"max":{}},"entries":{"human-needed":[{"counter":17140439526438552188,"replica":"788724f1-c261-6a6d-2987-01e3e1882f58"}]}},"priority":3,"status":"open","title":"llms.txt standard - AI agent discoverability","type":"feature"}
