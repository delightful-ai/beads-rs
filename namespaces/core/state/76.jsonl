{"_at":[1766124452435,0],"_by":"darin@dusk","_v":{"acceptance_criteria":[[1766116455164,0],"darin@dusk"],"claim":[[1766124452335,0],"darin@dusk"],"description":[[1766116455164,0],"darin@dusk"],"design":[[1766116455164,0],"darin@dusk"],"estimated_minutes":[[1766116455164,0],"darin@dusk"],"external_ref":[[1766116455164,0],"darin@dusk"],"labels":[[1766116455164,0],"darin@dusk"],"priority":[[1766116455164,0],"darin@dusk"],"source_repo":[[1766116455164,0],"darin@dusk"],"title":[[1766116455164,0],"darin@dusk"],"type":[[1766116455164,0],"darin@dusk"]},"assignee":"darin@dusk","assignee_at":[1766124452335,0],"assignee_expires":1766128052335,"closed_at":[1766124452435,0],"closed_by":"darin@dusk","created_at":[1766116455164,0],"created_by":"darin@dusk","description":"**Problem**\nIn `Daemon::complete_sync`, if mutations happened during sync and `CanonicalState::join` fails, the code discards local state and keeps `synced_state`. That can drop mutations made during the sync window.\n\n**Design**\nWhen join fails, detect/resolution collisions (reuse `git::collision` logic) and retry the merge. If merge still fails, keep local state, mark dirty, and surface/log the failure so operators can intervene.\n\n**Acceptance**\n- [ ] Local mutations are never dropped on join failure\n- [ ] Collision resolution is applied for dirty-after-sync merges\n- [ ] Tests cover the join-failure path\n- [ ] Tests pass\n\n**Files:** src/daemon/core.rs, src/git/collision.rs","id":"bd-1p0","labels":[],"priority":0,"status":"closed","title":"complete_sync must not drop local mutations on join failure","type":"bug"}
{"_at":[1768000108829,1],"_by":"darin@darinsmacstudio.lan","_v":{"acceptance_criteria":[[1765744959621,0],"darin@book"],"claim":[[1768000012768,1],"darin@darinsmacstudio.lan"],"description":[[1765744959621,0],"darin@book"],"design":[[1765744959621,0],"darin@book"],"estimated_minutes":[[1765744959621,0],"darin@book"],"external_ref":[[1765744959621,0],"darin@book"],"labels":[[1765744959621,0],"darin@book"],"priority":[[1765744959621,0],"darin@book"],"source_repo":[[1765744959621,0],"darin@book"],"title":[[1765744959621,0],"darin@book"],"type":[[1765744959621,0],"darin@book"]},"assignee":"darin@darinsmacstudio.lan","assignee_at":[1768000012768,1],"assignee_expires":1768003612768,"closed_at":[1768000108829,1],"closed_by":"darin@darinsmacstudio.lan","created_at":[1765744959621,0],"created_by":"darin@book","description":"**Problem**\n`run.rs` and `server.rs` both implement near-identical client handling. Duplication.\n\nAlso: `handle_request` has a `SyncWait` branch thats basically dead because the state loop intercepts it.\n\n**Design**\n- Extract shared client handling into single module\n- Prune dead `SyncWait` branch (or make it the single source of truth)\n- Reduce overall code duplication\n\n**Acceptance**\n- [ ] Single client handling implementation\n- [ ] Dead code removed\n- [ ] Existing behavior preserved\n\n**Files:** src/daemon/run.rs, src/daemon/server.rs","id":"bd-cze","labels":[],"priority":3,"status":"closed","title":"Unify run.rs and server.rs client handling","type":"chore"}
