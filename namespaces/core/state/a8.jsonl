{"_at":[1768377098659,1],"_by":"darin@book","_v":{"acceptance_criteria":[[1768178966154,1],"darin@darinsmacstudio.lan"],"claim":[[1768376053332,1],"darin@book"],"description":[[1768178966154,1],"darin@darinsmacstudio.lan"],"design":[[1768178966154,1],"darin@darinsmacstudio.lan"],"estimated_minutes":[[1768178966154,1],"darin@darinsmacstudio.lan"],"external_ref":[[1768178966154,1],"darin@darinsmacstudio.lan"],"labels":[[1768178966154,1],"darin@darinsmacstudio.lan"],"priority":[[1768178966154,1],"darin@darinsmacstudio.lan"],"source_repo":[[1768178966154,1],"darin@darinsmacstudio.lan"],"title":[[1768185463047,1],"darin@darinsmacstudio.lan"],"type":[[1768178966154,1],"darin@darinsmacstudio.lan"]},"assignee":"darin@book","assignee_at":[1768376053332,1],"assignee_expires":1768379653332,"closed_at":[1768377098659,1],"closed_by":"darin@book","created_at":[1768178966154,1],"created_by":"darin@darinsmacstudio.lan","description":"**Problem**\nbd-3m5.20 is too large. Split: local cache for fast startup.\n\n**Context**\n- REALTIME_PLAN.md ยง13.8 step 8 (cache publish)\n- Refines bd-3m5.20\n\n**Design**\n- Store verified copy under store_dir/checkpoint_cache/<group>/<checkpoint_id>/\n- Atomic publish: write to .tmp/, fsync, rename, update CURRENT\n- Keep last N checkpoints per group (default N=3), prune older\n- CURRENT file points to newest verified checkpoint_id\n\n**Acceptance**\n- [ ] Cache written atomically with tmp+rename\n- [ ] CURRENT updated after successful publish\n- [ ] Pruning keeps only N most recent\n- [ ] Startup reads from cache if available\n\n**Files:** src/git/checkpoint/cache.rs","id":"bd-3m5.50","labels":[],"priority":2,"status":"closed","title":"Phase 6: Checkpoint local cache with atomic publish","type":"task"}
{"_at":[1768528936494,1],"_by":"darin@book","_v":{"acceptance_criteria":[[1768506359496,1],"darin@book"],"claim":[[1768528263874,1],"darin@book"],"description":[[1768506359496,1],"darin@book"],"design":[[1768506359496,1],"darin@book"],"estimated_minutes":[[1768506359496,1],"darin@book"],"external_ref":[[1768506359496,1],"darin@book"],"labels":[[1768506359496,1],"darin@book"],"priority":[[1768506359496,1],"darin@book"],"source_repo":[[1768506359496,1],"darin@book"],"title":[[1768506359496,1],"darin@book"],"type":[[1768506359496,1],"darin@book"]},"acceptance_criteria":"- [ ] WAL replay tracker uses Seq types end-to-end (no raw u64 for seq).\n- [ ] WalReplayError variants carry `NamespaceId` + Seq types.\n- [ ] Tests updated to cover the new typed errors/invariants.","assignee":"darin@book","assignee_at":[1768528263874,1],"assignee_expires":1768531863874,"closed_at":[1768528936494,1],"closed_by":"darin@book","created_at":[1768506359496,1],"created_by":"darin@book","description":"**Problem**\nWAL replay code stores sequences as raw `u64` and error variants carry `namespace: String` + `seq: u64` (e.g., `WalReplayError::NonContiguousSeq`, `PrevShaMismatch`, `MissingHead`). `ReplayTracker`/`OriginReplayState` also use raw `u64`, forcing manual `seq == 0` checks and losing invariants that should be enforced by `Seq0`/`Seq1` and `NamespaceId`.\n\n**Files**\n- src/daemon/wal/replay.rs\n","design":"**Design**\n- Refactor `ReplayTracker`/`OriginReplayState` to use `Seq0`/`Seq1` types for `max_seq`/`contiguous_seq` and comparisons.\n- Update `WalReplayError` fields to use `NamespaceId` and typed seqs (`Seq0`/`Seq1`) instead of `String`/`u64`.\n- Adjust error mapping/helpers and tests accordingly.","id":"bd-ngbq","labels":[],"priority":3,"status":"closed","title":"WAL replay should use typed seq/namespace in tracker + errors","type":"chore"}
