{"_at":[1770498846245,0],"_by":"darin@darinsmcstudio2.lan","acceptance_criteria":"- [ ] Full inventory under CLI tree\n- [ ] Replacement target per symbol\n- [ ] Missing APIs called out explicitly","assignee":"darin@darins-Mac-Studio-2.local","created_at":[1770498230449,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nCLI still imports daemon internals, creating scatter and brittle coupling.","design":"Produce file+symbol inventory and map each import to `beads-surface`/`beads-api` replacement or missing API.","id":"bd-21eg.2","labels":{"cc":{"max":{}},"entries":{}},"priority":1,"status":"closed","title":"Inventory CLI -> daemon direct imports with replacement targets","type":"task"}
{"_at":[1768478723640,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@book","created_at":[1768454409818,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nREALTIME_PLAN §6.2 notes we should periodically run `PRAGMA wal_checkpoint(TRUNCATE)` for `wal.sqlite` to control the SQLite WAL file. There is no code path invoking `wal_checkpoint` at all.\n\n**Design**\n- Add a background/maintenance hook (e.g., in checkpoint scheduler loop or on a timer) to run `wal_checkpoint(TRUNCATE)` on wal.sqlite.\n- Make frequency configurable or piggy‑back on existing periodic tasks.\n\n**Acceptance**\n- [ ] wal_checkpoint(TRUNCATE) runs periodically.\n- [ ] Frequency is configurable or documented.\n- [ ] Tests or instrumentation confirm it triggers.\n\n**Files:** src/daemon/wal/index.rs, src/daemon/core.rs (or scheduler)","id":"bd-3m5.105","labels":{"cc":{"max":{}},"entries":{}},"priority":3,"status":"closed","title":"wal.sqlite checkpoint/truncate not scheduled","type":"bug"}
{"_at":[1768435428277,0],"_by":"darin@darinsmcstudio2.lan","acceptance_criteria":"- [ ] Subscribe streams events in order and closes on disconnect.\n- [ ] require_min_seen gating works and returns retryable errors on timeout.\n- [ ] Backpressure limits prevent unbounded buffering.","assignee":"darin@book","created_at":[1768177958315,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nPhase 7: implement IPC Subscribe streaming with require_min_seen gating. IPC is currently request or response only and has no streaming path.\n\n**Context**\n- REALTIME_PLAN.md §11 (local subscriptions), §16.1 (require_min_seen and timeout semantics)\n**Files:** src/daemon/ipc.rs, src/daemon/server.rs, src/daemon/broadcast.rs, src/api/mod.rs","design":"**Design**\n- Add a Subscribe request variant with namespace, require_min_seen, and wait_timeout_ms.\n- Stream EventBody bytes plus sha and prev_sha headers.\n- Use EventBroadcaster for live updates and WAL read for historical backfill.\n- If require_min_seen is not satisfied, wait up to wait_timeout_ms then return retryable error with current watermarks.","id":"bd-3m5.23","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Phase 7: IPC Subscribe streaming + require_min_seen","type":"task"}
{"_at":[1768799554182,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@book","created_at":[1768777659442,0],"created_by":"darin@darinsmcstudio2.lan","description":"tests/integration/fixtures/repl_rig.rs create_issue runs bd via assert_cmd for every write. Use IpcClient + Request::Create, parse ResponsePayload, and reuse client per node to avoid process spawn overhead. Speeds repl_e2e + wal rotation stress.","id":"bd-ero6","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"ReplRig create_issue spawns bd CLI; switch to IpcClient","type":"chore"}
{"_at":[1768821917081,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@book","created_at":[1768776086984,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nWe cannot trace a mutation across replicas end‑to‑end. There is no stable correlation/trace id that survives IPC → WAL → replication → apply, so distributed debugging is manual.\n\n**Design**\n- Introduce a `TraceId` (UUID or 128‑bit) in mutation context.\n- If `client_request_id` exists, derive/use it; otherwise generate a new `TraceId` at request entry.\n- Persist `trace_id` in event metadata (wire/event body or record header) and include it in repl frames.\n- Emit `trace_id` on spans/logs for mutation planning, WAL append/apply, replication send/receive, and checkpoint/apply paths.\n- Ensure backward‑compatible decoding (missing trace_id ok).\n\n**Acceptance**\n- [ ] A mutation creates or carries a `trace_id` that appears in local WAL and replicated events.\n- [ ] Logs/spans for mutation + repl include `trace_id`.\n- [ ] Older events without trace_id still decode and apply.\n\n**Files:** src/core/event.rs, src/core/wire_bead.rs, src/daemon/executor.rs, src/daemon/repl/*, src/daemon/ipc/*","id":"bd-kvqe","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Observability: add cross-replica trace_id propagation","type":"feature"}
{"_at":[1768626943686,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@book","created_at":[1768625370615,0],"created_by":"darin@darinsmcstudio2.lan","description":"Add logging/tracing configuration with file retention + pluggable logger/tracer interfaces. Ensure realtime spans include store/replica/namespace/txn context.","id":"bd-t7tz","labels":{"cc":{"max":{}},"entries":{}},"priority":1,"status":"closed","title":"Telemetry: logger/tracer interfaces + log retention + trace context","type":"task"}
