{"_at":[1768397061618,1],"_by":"darin@book","_v":{"acceptance_criteria":[[1768178812759,1],"darin@darinsmacstudio.lan"],"claim":[[1768396371229,1],"darin@book"],"description":[[1768178812759,1],"darin@darinsmacstudio.lan"],"design":[[1768178812759,1],"darin@darinsmacstudio.lan"],"estimated_minutes":[[1768178812759,1],"darin@darinsmacstudio.lan"],"external_ref":[[1768178812759,1],"darin@darinsmacstudio.lan"],"labels":[[1768178812759,1],"darin@darinsmacstudio.lan"],"priority":[[1768178812759,1],"darin@darinsmacstudio.lan"],"source_repo":[[1768178812759,1],"darin@darinsmacstudio.lan"],"title":[[1768185421068,1],"darin@darinsmacstudio.lan"],"type":[[1768178812759,1],"darin@darinsmacstudio.lan"]},"assignee":"darin@book","assignee_at":[1768396371229,1],"assignee_expires":1768399971229,"closed_at":[1768397061618,1],"closed_by":"darin@book","created_at":[1768178812759,1],"created_by":"darin@darinsmacstudio.lan","description":"**Problem**\nOperators need to quickly detect divergence across replicas using stable convergence fingerprints.\n\n**Context**\n- REALTIME_PLAN.md ยง16.1 (admin.fingerprint, fingerprint algorithm)\n\n**Design**\n- Returns per-namespace: { state_sha256, tombstones_sha256, deps_sha256, namespace_root }\n- Merkle-ish algorithm: shard_hash[00..ff] -> type_root -> namespace_root\n- Modes: full (per-shard hashes, expensive), sample(N) (deterministic N samples)\n- Sampling uses sha256(namespace || request_nonce) to select indices\n- Includes watermarks_applied and watermarks_durable as basis\n\n**Acceptance**\n- [ ] admin.fingerprint returns namespace_root and type_roots\n- [ ] full mode returns per-shard hashes\n- [ ] sample(N) returns deterministic shard samples\n- [ ] Tests verify determinism (same state -> same hash)\n\n**Files:** src/daemon/admin.rs, src/daemon/fingerprint.rs (new), src/cli/commands/admin.rs","id":"bd-3m5.34","labels":[],"priority":2,"status":"closed","title":"Phase 7: admin.fingerprint for divergence detection","type":"task"}
{"_at":[1768533158463,1],"_by":"darin@book","_v":{"acceptance_criteria":[[1768508733099,1],"darin@book"],"claim":[[1768531469488,1],"darin@book"],"description":[[1768508733099,1],"darin@book"],"design":[[1768508733099,1],"darin@book"],"estimated_minutes":[[1768508733099,1],"darin@book"],"external_ref":[[1768508733099,1],"darin@book"],"labels":[[1768508733099,1],"darin@book"],"priority":[[1768508733099,1],"darin@book"],"source_repo":[[1768508733099,1],"darin@book"],"title":[[1768508733099,1],"darin@book"],"type":[[1768508733099,1],"darin@book"]},"acceptance_criteria":"- [ ] `query.rs` and `query_executor.rs` no longer import `crate::api`.\n- [ ] API conversions happen at the edge (IPC response assembly).\n- [ ] Behavior unchanged; tests pass.","assignee":"darin@book","assignee_at":[1768531469488,1],"assignee_expires":1768535069488,"closed_at":[1768533158463,1],"closed_by":"darin@book","created_at":[1768508733099,1],"created_by":"darin@book","description":"**Problem**\n- `src/daemon/query.rs` and `src/daemon/query_executor.rs` return `crate::api` view types directly.\n- This couples internal query logic to external schemas and makes refactors harder.\n\n**Files:**\n- src/daemon/query.rs\n- src/daemon/query_executor.rs\n- src/api/mod.rs\n- src/daemon/ipc.rs (response assembly)","design":"- Introduce internal query view types (e.g., `daemon/query_model.rs`) that are independent of `api`.\n- Update query executor to return internal types.\n- Add `From` conversions in `src/api` (or a dedicated `api/convert.rs`) to build API output at the IPC boundary.\n- Ensure CLI rendering still uses API types.","id":"bd-bzxc","labels":[],"priority":2,"status":"closed","title":"Query/API boundary: internal models + edge conversion","type":"chore"}
