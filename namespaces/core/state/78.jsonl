{"_at":[1768247269893,1],"_by":"darin@darinsmacstudio.lan","_v":{"acceptance_criteria":[[1768180765428,1],"darin@darinsmacstudio.lan"],"claim":[[1768246663446,1],"darin@darinsmacstudio.lan"],"description":[[1768195922099,1],"darin@darinsmacstudio.lan"],"design":[[1768180765428,1],"darin@darinsmacstudio.lan"],"estimated_minutes":[[1768180765428,1],"darin@darinsmacstudio.lan"],"external_ref":[[1768180765428,1],"darin@darinsmacstudio.lan"],"labels":[[1768180765428,1],"darin@darinsmacstudio.lan"],"priority":[[1768180765428,1],"darin@darinsmacstudio.lan"],"source_repo":[[1768180765428,1],"darin@darinsmacstudio.lan"],"title":[[1768180765428,1],"darin@darinsmacstudio.lan"],"type":[[1768180765428,1],"darin@darinsmacstudio.lan"]},"assignee":"darin@darinsmacstudio.lan","assignee_at":[1768246663446,1],"assignee_expires":1768250263446,"closed_at":[1768247269893,1],"closed_by":"darin@darinsmacstudio.lan","created_at":[1768180765428,1],"created_by":"darin@darinsmacstudio.lan","description":"**Problem**\nPhase 3 implementation must be verified before Phase 4 starts.\n\n**Context**\n- REALTIME_PLAN.md §18: WAL framing/truncation, index rebuild, origin_seq allocation\n- Depends on: Phase 3 implementation + Phase 3 test infrastructure\n\n**Design**\nDeterministic tests for:\n- WAL framing: write records, read back, verify crc32c\n- Tail truncation: partial record at EOF → truncate and recover\n- WAL index rebuild: delete wal.sqlite, rebuild from segments, verify offsets\n- Incremental catch-up: last_indexed_offset -> scan to EOF and index\n- origin_seq allocation: append → seq increments monotonically, no gaps\n\n**Acceptance**\n- [ ] tests/phase3_wal.rs: framing + truncation tests\n- [ ] tests/phase3_index.rs: index rebuild + catch-up tests\n- [ ] tests/phase3_seq.rs: origin_seq allocation tests\n- [ ] cargo test phase3_ passes\n\n**Files:** tests/phase3_wal.rs (new), tests/phase3_index.rs (new), tests/phase3_seq.rs (new)","id":"bd-3m5.58","labels":[],"priority":2,"status":"closed","title":"Phase 3 tests: WAL framing + index rebuild + origin_seq","type":"task"}
{"_at":[1768535261373,1],"_by":"darin@book","_v":{"acceptance_criteria":[[1768503831170,1],"darin@book"],"claim":[[1768535179091,1],"darin@book"],"description":[[1768503831170,1],"darin@book"],"design":[[1768503831170,1],"darin@book"],"estimated_minutes":[[1768503831170,1],"darin@book"],"external_ref":[[1768503831170,1],"darin@book"],"labels":[[1768503831170,1],"darin@book"],"priority":[[1768503831170,1],"darin@book"],"source_repo":[[1768503831170,1],"darin@book"],"title":[[1768503831170,1],"darin@book"],"type":[[1768503831170,1],"darin@book"]},"acceptance_criteria":"- [ ] RepoState has no wal_sequence field.\n- [ ] No references remain in code or tests.","assignee":"darin@book","assignee_at":[1768535179091,1],"assignee_expires":1768538779091,"closed_at":[1768535261373,1],"closed_by":"darin@book","created_at":[1768503831170,1],"created_by":"darin@book","description":"**Problem**\nRepoState.wal_sequence is never read or written outside struct initialization (src/daemon/repo.rs). It is a legacy snapshot-WAL counter and no longer reflects the realtime event WAL sequencing (per-namespace origin_seq). Keeping it is misleading and dead.\n\n**Files:** src/daemon/repo.rs","design":"**Design**\n- Remove wal_sequence from RepoState and its initializers.\n- Scan for any remaining uses; if any are discovered, either delete or replace with the correct event-WAL sequencing concept.","id":"bd-pkcb","labels":[],"priority":3,"status":"closed","title":"Remove dead RepoState.wal_sequence","type":"chore"}
