{"_at":[1768206011449,1],"_by":"darin@darinsmacstudio.lan","_v":{"acceptance_criteria":[[1768177801439,1],"darin@darinsmacstudio.lan"],"claim":[[1768202515550,1],"darin@darinsmacstudio.lan"],"description":[[1768177801439,1],"darin@darinsmacstudio.lan"],"design":[[1768177801439,1],"darin@darinsmacstudio.lan"],"estimated_minutes":[[1768177801439,1],"darin@darinsmacstudio.lan"],"external_ref":[[1768177801439,1],"darin@darinsmacstudio.lan"],"labels":[[1768177801439,1],"darin@darinsmacstudio.lan"],"priority":[[1768177801439,1],"darin@darinsmacstudio.lan"],"source_repo":[[1768177801439,1],"darin@darinsmacstudio.lan"],"title":[[1768177801439,1],"darin@darinsmacstudio.lan"],"type":[[1768177801439,1],"darin@darinsmacstudio.lan"]},"acceptance_criteria":"- [ ] Daemon state keyed by StoreId; remote URL only used for legacy git lane mapping.\n- [ ] Store discovery order matches plan and is covered by tests or structured logs.\n- [ ] Existing commands still resolve a store from repo path (compat) without behavior regression.","assignee":"darin@darinsmacstudio.lan","assignee_at":[1768202515550,1],"assignee_expires":1768206115550,"closed_at":[1768206011449,1],"closed_by":"darin@darinsmacstudio.lan","created_at":[1768177801439,1],"created_by":"darin@darinsmacstudio.lan","description":"**Problem**\nPhase 3: introduce StoreRuntime and move daemon identity from RemoteUrl to StoreId (hybrid mapping). Today `Daemon` is keyed by `RemoteUrl` and uses `path_to_remote` in `src/daemon/core.rs`, which blocks per store WAL and replication.\n\n**Context**\n- REALTIME_PLAN.md ยง0.1 (StoreId as correctness identity) and ยง7.1-7.4 (StoreRuntime + discovery order)\n- Migration fallback UUIDv5(normalized_remote_url) in ยง0.16\n**Files:** src/daemon/core.rs, src/daemon/remote.rs, src/daemon/repo.rs, src/paths.rs, src/daemon/store_runtime.rs (new)","design":"**Design**\n- Add `StoreRuntime` struct (initially minimal fields: meta, policies, state, watermarks, wal handle) in `src/daemon/store_runtime.rs`.\n- Change `Daemon` maps to `BTreeMap<StoreId, StoreRuntime>` plus `path_to_store_id` and `remote_to_store_id` caches.\n- Implement store identity discovery order: local store meta.json, refs/beads/meta store_meta.json, refs/beads/<store_id> listing, UUIDv5(normalized_remote_url) fallback for migration only.\n- Keep RemoteUrl mapping for legacy git sync, but do not key correctness on it.","id":"bd-3m5.8","labels":[],"priority":2,"status":"closed","title":"Phase 3: StoreRuntime + StoreId identity mapping","type":"task"}
{"_at":[1768253578193,1],"_by":"darin@darinsmacstudio.lan","_v":{"acceptance_criteria":[[1768245268042,1],"darin@darinsmacstudio.lan"],"claim":[[1768245268042,1],"darin@darinsmacstudio.lan"],"description":[[1768245268042,1],"darin@darinsmacstudio.lan"],"design":[[1768245268042,1],"darin@darinsmacstudio.lan"],"estimated_minutes":[[1768245268042,1],"darin@darinsmacstudio.lan"],"external_ref":[[1768245268042,1],"darin@darinsmacstudio.lan"],"labels":[[1768245268042,1],"darin@darinsmacstudio.lan"],"priority":[[1768245268042,1],"darin@darinsmacstudio.lan"],"source_repo":[[1768245268042,1],"darin@darinsmacstudio.lan"],"title":[[1768245268042,1],"darin@darinsmacstudio.lan"],"type":[[1768245268042,1],"darin@darinsmacstudio.lan"]},"closed_at":[1768253578193,1],"closed_by":"darin@darinsmacstudio.lan","closed_reason":"duplicate stub - no description","created_at":[1768245268042,1],"created_by":"darin@darinsmacstudio.lan","description":"","id":"bd-ay2","labels":[],"priority":2,"status":"closed","title":"Crash recovery","type":"task"}
