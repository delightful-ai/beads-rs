{"_at":[1768402736558,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@book","created_at":[1768180781069,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nPhase 4 tests need mutation request factories and receipt comparison helpers.\n\n**Context**\n- REALTIME_PLAN.md Â§18: idempotency mapping/receipts\n- Blocks Phase 4 testing bead\n\n**Design**\nCreate test infrastructure:\n- Mutation request builders (bead_upsert, dep_add, note_append)\n- Request canonicalization helpers for request_sha256\n- DurabilityReceipt comparison utilities\n- Idempotency test harness: send request, get receipt, retry, verify same receipt\n\n**Acceptance**\n- [ ] tests/fixtures/mutation.rs with request builders\n- [ ] tests/fixtures/receipt.rs with receipt comparison helpers\n- [ ] Builders support all TxnDeltaV1 operation types\n- [ ] cargo test fixtures::mutation passes\n\n**Files:** tests/fixtures/mutation.rs (new), tests/fixtures/receipt.rs (new)","id":"bd-3m5.59","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Phase 4 test infrastructure: mutation request factories","type":"task"}
{"_at":[1768622484942,0],"_by":"darin@darinsmcstudio2.lan","created_at":[1768622484942,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nNeed swarm coordination commands for multi-agent parallel work on epics. Swarms are DIFFERENT from molecules - they're descriptive (compute ready fronts) vs prescriptive (define workflow).\n\n**What are Swarms?**\nSwarms are multi-agent coordination for parallel epic execution:\n- Analyze: Compute ready fronts (waves of parallel work)\n- Validate: Check epic structure (cycles, inversions, disconnected subgraphs)\n- Status: Show current progress (completed/active/ready/blocked)\n- Create: Link swarm molecule to epic (mol_type=swarm)\n\n**Key Insight**\nSwarms compute ready work from epic dependency graphs. They DON'T prescribe workflow - they discover parallelism opportunities.\n\n**Commands**\n- bd swarm validate <epic-id> - analyze structure, show waves\n- bd swarm status <epic-id> - current execution state\n- bd swarm create <epic-id> - create swarm molecule\n- bd swarm list - list active swarms\n\n**How it Works (Go beads)**\n1. Load epic + all children\n2. Build dependency graph (only within epic)\n3. Topological sort to find ready fronts (Kahn's algorithm)\n4. Detect structural issues (cycles, inversions, disconnected)\n5. Compute max parallelism and estimated sessions\n6. Create swarm molecule (mol_type=swarm, links via relates-to)\n\n**Swarm Analysis Output**\n- Ready fronts: Wave 1 (issues ready now), Wave 2 (after Wave 1), etc.\n- Max parallelism: Largest wave size\n- Estimated sessions: Total issue count\n- Warnings: Potential dependency inversions, disconnected subgraphs\n- Errors: Cycles (makes epic non-swarmable)\n\n**Molecule vs Swarm**\n- Molecule (prescriptive): Template defines workflow (proto â†’ pour â†’ execute)\n- Swarm (descriptive): Analyze existing epic, compute ready work\n\n**Design Considerations**\n- Dependency graph traversal\n- Topological sort with level tracking\n- Cycle detection\n- Heuristic warnings (\"foundation\" issues with no dependents)\n- SwarmAnalysis struct with ready fronts\n- MolType enum (swarm/patrol/work)\n\n**Files to Study (Go beads)**\n- cmd/bd/swarm.go - all swarm commands\n- internal/types/types.go - MolType field (line ~114)\n- docs/MOLECULES.md - swarm explanation (line 21-26)\n\n**Acceptance**\n- [ ] MolType field added to Issue\n- [ ] bd swarm validate command\n- [ ] bd swarm status command  \n- [ ] bd swarm create command\n- [ ] bd swarm list command\n- [ ] Ready front computation (Kahn's algorithm)\n- [ ] Cycle detection\n- [ ] Structural issue warnings\n- [ ] Tests for swarm analysis\n","id":"bd-ze0x.32","labels":{"cc":{"max":{}},"entries":{"human-needed":[{"counter":16418486850439135454,"replica":"5f3785ea-5661-6d1e-7adc-7479efe8c166"}]}},"priority":2,"status":"open","title":"Add bd swarm commands to beads-rs","type":"epic"}
{"_at":[1768622544109,0],"_by":"darin@darinsmcstudio2.lan","created_at":[1768622544109,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nUsers need visibility into issue and workflow changes as they happen. Go beads has `bd activity` for real-time mutation event streaming.\n\n**Design**\nImplement `bd activity` command that shows mutation events:\n\n**Event Types**:\n- create: new issue created\n- update: issue modified\n- delete: issue removed\n- comment: comment added\n- status_change: workflow state transition\n\n**Flags**:\n- `--follow` / `-f`: stream events in real-time (like tail -f)\n- `--since <duration>`: show events from last N time (e.g., \"5m\", \"1h\", \"30s\")\n- `--type <type>`: filter by event type (create, update, delete, comment)\n- `--limit <n>`: max events to show (default 100)\n- `--interval <duration>`: polling interval for --follow mode (default 500ms)\n\n**Output Format** (human):\n```\n2025-01-16 14:30:45  +  bd-abc123  Created: Fix auth timeout\n2025-01-16 14:31:20  â†’  bd-abc123  Status: open â†’ in_progress\n2025-01-16 14:35:00  âœ“  bd-abc123  Closed: fixed\n```\n\n**Event Symbols**:\n- `+` created\n- `â†’` status change / update\n- `âœ“` closed/completed\n- `âŠ˜` deleted\n- `ðŸ’¬` comment added\n\n**JSON Output**:\n```json\n{\n  \"timestamp\": \"2025-01-16T14:30:45Z\",\n  \"type\": \"create\",\n  \"issue_id\": \"bd-abc123\",\n  \"message\": \"Created: Fix auth timeout\",\n  \"actor\": \"user@example.com\"\n}\n```\n\nReference: `/Users/darin/Projects/beads-rs-macstudio/tmp/beads/cmd/bd/activity.go`\n\n**Design Notes**\n- Store events in `events` table with timestamp, type, issue_id, actor, payload\n- Query events with timestamp ordering (DESC for recent first)\n- --follow mode: poll database every N ms, show new events since last poll\n- Use chrono for duration parsing (--since)\n- Respect --json for machine-readable output\n\n**Implementation**:\n1. Add events table to schema (if not exists)\n2. Emit events on create/update/delete operations\n3. CLI command to query and display events\n4. Streaming mode with polling loop\n\n**Acceptance**\n- [ ] bd activity shows last 100 events by default\n- [ ] --follow streams events in real-time\n- [ ] --since filters by time duration\n- [ ] --type filters by event type\n- [ ] Event symbols (+ â†’ âœ“ âŠ˜ ðŸ’¬)\n- [ ] JSON output with --json\n- [ ] Timestamp + actor in each event\n- [ ] Efficient polling in follow mode (500ms default)\n\n**Files:**\n- `src/cli/activity.rs` (new)\n- `src/core/events.rs` (new - event emission and storage)\n- `src/git/sync.rs` (emit events on mutations)\n- `migrations/XXX_add_events_table.sql` (if needed)","id":"bd-ze0x.45","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"open","title":"bd activity command for real-time mutation stream","type":"feature"}
