{"_at":[1768541272969,1],"_by":"darin@book","_v":{"acceptance_criteria":[[1768508732268,1],"darin@book"],"claim":[[1768538839631,1],"darin@book"],"description":[[1768508732268,1],"darin@book"],"design":[[1768508732268,1],"darin@book"],"estimated_minutes":[[1768508732268,1],"darin@book"],"external_ref":[[1768508732268,1],"darin@book"],"labels":[[1768508732268,1],"darin@book"],"priority":[[1768508732268,1],"darin@book"],"source_repo":[[1768508732268,1],"darin@book"],"title":[[1768508732268,1],"darin@book"],"type":[[1768508732268,1],"darin@book"]},"acceptance_criteria":"- [ ] Coordinator logic is in its own module with a clear API.\n- [ ] `src/daemon/core.rs` shrinks to wiring + data holders or is replaced by a coordinator module.\n- [ ] Server loop uses the coordinator interface without behavior changes.\n- [ ] `cargo test` passes.","assignee":"darin@book","assignee_at":[1768538839631,1],"assignee_expires":1768542439631,"closed_at":[1768541272969,1],"closed_by":"darin@book","created_at":[1768508732268,1],"created_by":"darin@book","description":"**Problem**\n- `src/daemon/core.rs` is a ~4.7k-line god module mixing request dispatch, read gates, scheduling, replication handles, and store access.\n- Coordinator logic is hard to reason about and hard to test in isolation.\n\n**Files:**\n- src/daemon/core.rs\n- src/daemon/server.rs\n- src/daemon/executor.rs\n- src/daemon/query_executor.rs\n- src/daemon/mod.rs","design":"- Introduce `src/daemon/coord/` (or `coordinator.rs`) containing request dispatch, read gating, and scheduling.\n- `Daemon` becomes a thin facade or a type alias to `Coordinator` to preserve API shape.\n- Move helpers like `handle_request`, `normalize_*`, and deadline calculations into the coordinator module.\n- Keep executor/query modules unchanged except for imports.","id":"bd-4v16","labels":[],"priority":2,"status":"closed","title":"Refactor daemon coordinator/request routing","type":"chore"}
