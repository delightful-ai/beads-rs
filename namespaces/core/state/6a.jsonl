{"_at":[1768426332260,1],"_by":"darin@book","_v":{"acceptance_criteria":[[1766127735338,1],"darin@dusk"],"claim":[[1768426250707,1],"darin@book"],"description":[[1766127735338,1],"darin@dusk"],"design":[[1766127735338,1],"darin@dusk"],"estimated_minutes":[[1766127735338,1],"darin@dusk"],"external_ref":[[1766127735338,1],"darin@dusk"],"labels":[[1766127735338,1],"darin@dusk"],"priority":[[1766127735338,1],"darin@dusk"],"source_repo":[[1766127735338,1],"darin@dusk"],"title":[[1766127735338,1],"darin@dusk"],"type":[[1766127735338,1],"darin@dusk"]},"assignee":"darin@book","assignee_at":[1768426250707,1],"assignee_expires":1768429850707,"closed_at":[1768426332260,1],"closed_by":"darin@book","created_at":[1766127735338,1],"created_by":"darin@dusk","description":"**Problem**\nWe still lack an integration test that proves WAL recovery works after an unclean daemon crash. Data loss here would be catastrophic.\n\n**Design**\nAdd an integration test that:\n1) creates a repo with a bare remote\n2) starts the daemon (via bd create --json) and captures PID via IPC Ping\n3) performs a mutation (bd create) and verifies WAL file exists\n4) SIGKILL the daemon immediately (kill -9) before sync finishes\n5) restart via any bd command (autostart)\n6) assert the bead is present (bd list/show) and can be synced to remote\nUse per-test XDG_RUNTIME_DIR + BD_WAL_DIR temp dirs to avoid cross-test leakage.\n\n**Acceptance**\n- [ ] Test passes reliably\n- [ ] WAL replay is asserted (data present after restart)\n- [ ] No flakiness in CI\n\n**Files:** tests/critical_path.rs (or new tests/robustness.rs), src/daemon/ipc.rs (if needed)","id":"bd-bk2","labels":[],"priority":0,"status":"closed","title":"Crash recovery integration test (kill -9 WAL replay)","type":"bug"}
{"_at":[1768514087706,1],"_by":"darin@book","_v":{"acceptance_criteria":[[1768503201562,1],"darin@book"],"claim":[[1768513037242,1],"darin@book"],"description":[[1768503201562,1],"darin@book"],"design":[[1768503201562,1],"darin@book"],"estimated_minutes":[[1768503201562,1],"darin@book"],"external_ref":[[1768503201562,1],"darin@book"],"labels":[[1768503201562,1],"darin@book"],"priority":[[1768503201562,1],"darin@book"],"source_repo":[[1768503201562,1],"darin@book"],"title":[[1768503201562,1],"darin@book"],"type":[[1768503201562,1],"darin@book"]},"acceptance_criteria":"- [ ] Internal mutation flow uses typed `ParsedMutationMeta` (no raw strings).\n- [ ] Invalid namespace/durability/actor/client_request_id values fail at IPC boundary with clear errors.\n- [ ] Duplicate parsing logic removed.","assignee":"darin@book","assignee_at":[1768513037242,1],"assignee_expires":1768516637242,"closed_at":[1768514087706,1],"closed_by":"darin@book","created_at":[1768503201562,1],"created_by":"darin@book","description":"**Problem**\n`MutationMeta` in `src/daemon/ipc.rs` stores `namespace`, `durability`, `actor_id`, and `client_request_id` as `Option<String>`. These are parsed later (and in multiple places), which makes error handling inconsistent and keeps invalid values alive deep into the realtime pipeline.\n\n**Files**\n- src/daemon/ipc.rs\n- src/daemon/core.rs (parse_durability)\n- src/daemon/mutation_engine.rs","design":"Introduce an internal `ParsedMutationMeta` that uses `NamespaceId`, `DurabilityClass`, `ActorId`, and `ClientRequestId`. Parse/validate once at IPC boundary (or in a dedicated conversion layer) and propagate the typed struct through `MutationContext` / executor. Move `parse_durability` into a shared helper so the CLI/IPC use the same parser.","id":"bd-neu","labels":[],"priority":2,"status":"closed","title":"IPC: parse MutationMeta into typed namespace/durability/actor","type":"chore"}
{"_at":[1768525607619,1],"_by":"darin@book","_v":{"acceptance_criteria":[[1768510073390,1],"darin@book"],"claim":[[1768525581078,1],"darin@book"],"description":[[1768510073390,1],"darin@book"],"design":[[1768510073390,1],"darin@book"],"estimated_minutes":[[1768510073390,1],"darin@book"],"external_ref":[[1768510073390,1],"darin@book"],"labels":[[1768510073390,1],"darin@book"],"priority":[[1768510073390,1],"darin@book"],"source_repo":[[1768510073390,1],"darin@book"],"title":[[1768510073390,1],"darin@book"],"type":[[1768510073390,1],"darin@book"]},"assignee":"darin@book","assignee_at":[1768525581078,1],"assignee_expires":1768529181078,"closed_at":[1768525607619,1],"closed_by":"darin@book","closed_reason":"fixed by bd-zl6d timeout scaling","created_at":[1768510073390,1],"created_by":"darin@book","description":"","id":"bd-qw1v","labels":[],"priority":2,"status":"closed","title":"Integration test admin_status_monotonic_under_load can time out at 3s","type":"bug"}
