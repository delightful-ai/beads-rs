{"_at":[1765787192823,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@dusk","closed_reason":"Core goal achieved: eliminated all .unwrap() calls on bead lookups in daemon paths. Completed: serde boundary validation, DepKey encapsulation, LoadedRemote proof type, require_live helpers + refactoring, with_mutation helper. Remaining low-priority cleanup (bd-mgf, bd-di1) filed as separate beads.","created_at":[1765744471242,0],"created_by":"darin@darinsmcstudio2.lan","description":"Eliminate unwraps in daemon code by encoding proven invariants in the type system.\n\n**Goal:** No `unwrap()` in non-test daemon paths where failures can be caused by repo state or git IO.\n\n**Approach:** \"Parse, dont validate\" — move checks to where data enters the system and let types remember what has been validated.\n\n**Subtasks:**\n- Serde boundary validation for identity types\n- Encapsulate DepKey (no self-loops)\n- LoadedRemote proof type\n- require_live helper\n- with_mutation transaction helper\n- Collapse live/tombstones into BeadEntry\n- Remove duplicate key from DepEdge\n\nSee individual beads for design details.","id":"bd-2fr","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Type-safe daemon: eliminate invariant-checking unwraps","type":"epic"}
{"_at":[1768405890051,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@book","created_at":[1768180801903,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nPhase 5 implementation must be verified before Phase 6 starts.\n\n**Context**\n- REALTIME_PLAN.md §18: replication ACK/WANT behavior, backpressure\n- Depends on: Phase 5 implementation + Phase 5 test infrastructure\n\n**Design**\nDeterministic tests for:\n- ACK semantics: peer receives events, sends ACK, watermarks advance\n- WANT semantics: peer sends WANT, server responds with events from WAL\n- Gap handling: missing events → WANT for gap range\n- Backpressure: ingest queue full → stop reads or ERROR(overloaded)\n- Equivocation detection: same (origin, seq), different sha → error\n- prev_sha256 continuity: mismatched prev_sha → reject\n\n**Acceptance**\n- [ ] tests/phase5_repl_ack.rs: ACK/WANT tests\n- [ ] tests/phase5_repl_backpressure.rs: backpressure tests\n- [ ] Test: gap triggers WANT for missing range\n- [ ] Test: queue overflow triggers backpressure\n- [ ] cargo test phase5_ passes\n\n**Files:** tests/phase5_repl_ack.rs (new), tests/phase5_repl_backpressure.rs (new)","id":"bd-3m5.62","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Phase 5 tests: replication ACK/WANT + backpressure","type":"task"}
{"_at":[1768401054650,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@book","created_at":[1768271794890,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nErrorCode::{NamespacePolicyViolation,CrossNamespaceDependency} exist but have no OpError variants or IPC emission path, so namespace policy enforcement cannot surface structured errors.\n\n**Where**\n- src/core/error.rs: ErrorCode definitions\n- src/daemon/ops.rs: OpError missing variants\n\n**Design**\n- Add OpError variants and IPC mappings with structured details per registry.\n- Emit these codes from policy enforcement in replication/IPC admission once policies are loaded.\n\n**Acceptance**\n- Policy violations produce namespace_policy_violation or cross_namespace_dependency with details.\n\n**Files**\n- src/daemon/ops.rs\n- src/daemon/ipc.rs\n- src/daemon/* policy enforcement paths (post bd-3m5.17, bd-3m5.35)","id":"bd-3m5.77","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Namespace policy errors: emit namespace_policy_violation/cross_namespace_dependency","type":"task"}
