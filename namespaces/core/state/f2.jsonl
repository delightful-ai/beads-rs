{"_at":[1768289552843,0],"_by":"darin@darinsmcstudio2.lan","acceptance_criteria":"- [ ] Gap buffer enforces event and byte bounds and returns explicit Reject on overflow/timeout.\n- [ ] Only fully verified contiguous events are forwarded to WAL append.\n- [ ] Duplicate events are treated as no-ops without disturbing the buffer.\n- [ ] Unit tests cover: single gap, multiple gaps, overflow, timeout, deferred-prev behavior.","assignee":"darin@darinsmacstudio.lan","created_at":[1768178742774,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nOut-of-order replication needs a bounded gap buffer that is aware of contiguity and prev hash verification. A naive BTreeMap of bytes lets callers accidentally treat deferred prev checks as safe and doesn’t encode the decision outcomes.\n\n**Context**\n- REALTIME_PLAN.md §9.4 (contiguous ingest rule), §9.8 (gap handling + bounds)\n- Stateright model: beads_stateright_models/src/realtime_types_sketch.rs (GapBuffer, VerifiedEventAny, IngestDecision)\n\n**Files:** src/daemon/repl/gap_buffer.rs (new), src/daemon/repl/session.rs, src/daemon/store_runtime.rs","design":"**Design**\n- Implement GapBufferByNsOrigin keyed by (NamespaceId, ReplicaId) with per-origin gap state.\n- Store VerifiedEventAny so deferred prev checks remain explicit; only contiguous VerifiedEvent<PrevVerified> are forwarded to WAL append.\n- Provide ingest API returning an IngestDecision: ForwardContiguousBatch, BufferedNeedWant, DuplicateNoop, Reject(code).\n- Enforce per-origin bounds on buffered events and bytes, plus a timeout window; overflow or timeout returns Reject(\"gap_buffer_overflow\"/\"gap_timeout\").\n- Drain buffered suffix in order when the predecessor arrives; stop if a deferred event is still waiting on prev verification.","id":"bd-3m5.28","labels":{"cc":{"max":{}},"entries":{}},"priority":1,"status":"closed","title":"Phase 5: GapBufferByNsOrigin for replication","type":"task"}
{"_at":[1770592399026,0],"_by":"darin@darinsmcstudio2.lan","acceptance_criteria":"- [ ] All known ~61 non-exhaustive lint findings are resolved or intentionally quarantined with explicit, documented rationale.\n- [ ] No new wildcard/fallback enum match arms remain in core typed domain paths.\n- [ ] `cargo clippy --all-features -- -D warnings` passes in default workspace verification flow.\n- [ ] `just dylint` passes with boundary and style gates enabled.\n- [ ] `cargo test --all-features` passes.\n- [ ] At least one regression test covers a previously wildcarded match site that could have masked future variant additions.","assignee":"darin@darins-Mac-Studio-2.local","created_at":[1770579209628,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nStrict non-exhaustive matching policy is not fully enforceable yet because we still have ~61 existing findings that rely on wildcard/fallback match arms. This blocks turning the policy into a hard gate and leaves maintainability drift risk in critical paths.\n\n**Scope**\nClear the existing backlog and make the strict policy practical for day-to-day development without behavioral changes.\n\n**Files**\n- crates/beads-core/**\n- crates/beads-api/**\n- crates/beads-surface/**\n- crates/beads-daemon/**\n- crates/beads-daemon-core/**\n- crates/beads-cli/**\n- crates/beads-rs/**\n- lints/**\n- justfile\n- .github/workflows/**","design":"1. Inventory all non-exhaustive/wildcard match lint findings and bucket by crate + risk.\n2. Replace wildcard/fallback arms with explicit variant handling where behavior is known; avoid catch-all arms in typed domain logic.\n3. Where external/non_exhaustive APIs require compatibility handling, use clearly isolated boundary helpers rather than broad fallback behavior in core logic.\n4. Keep changes behavior-preserving: validate with existing tests and add focused regression tests for match behavior where ambiguity exists.\n5. Enable/retain strict lint gating so new fallback arms in typed enums are prevented by default CI flow.","id":"bd-82yl","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Clear strict non-exhaustive match lint backlog (~61 findings)","type":"chore"}
