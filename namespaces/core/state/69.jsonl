{"_at":[1768398416289,1],"_by":"darin@book","_v":{"acceptance_criteria":[[1768178814317,1],"darin@darinsmacstudio.lan"],"claim":[[1768397603118,1],"darin@book"],"description":[[1768178814317,1],"darin@darinsmacstudio.lan"],"design":[[1768178814317,1],"darin@darinsmacstudio.lan"],"estimated_minutes":[[1768178814317,1],"darin@darinsmacstudio.lan"],"external_ref":[[1768178814317,1],"darin@darinsmacstudio.lan"],"labels":[[1768178814317,1],"darin@darinsmacstudio.lan"],"priority":[[1768178814317,1],"darin@darinsmacstudio.lan"],"source_repo":[[1768178814317,1],"darin@darinsmacstudio.lan"],"title":[[1768185422620,1],"darin@darinsmacstudio.lan"],"type":[[1768178814317,1],"darin@darinsmacstudio.lan"]},"assignee":"darin@book","assignee_at":[1768397603118,1],"assignee_expires":1768401203118,"closed_at":[1768398416289,1],"closed_by":"darin@book","created_at":[1768178814317,1],"created_by":"darin@darinsmacstudio.lan","description":"**Problem**\nOperators need to reload namespace policies live and recover from replica_id collision.\n\n**Context**\n- REALTIME_PLAN.md ยง0.4 (reload semantics), ยง2.1.1 (replica_id collision)\n\n**Design**\n- admin.reload_policies: reloads namespaces.toml, validates, applies safe live changes\n  - Safe to apply: visibility, ready_eligible, retention windows, ttl_basis\n  - Requires restart: checkpoint group membership, replication listen params\n  - Returns diff summary (applied vs requires_restart)\n- admin.rotate_replica_id: generates new replica_id, updates meta.json, logs old->new mapping\n  - Used for recovery from duplicated store directories\n  - New replica starts with origin_seq=0 for new identity\n\n**Acceptance**\n- [ ] admin.reload_policies applies safe changes, reports restart-required changes\n- [ ] admin.rotate_replica_id generates new UUID and persists\n- [ ] CLI `bd admin reload-policies` and `bd admin rotate-replica-id` work\n- [ ] Tests verify policy reload diff\n\n**Files:** src/daemon/admin.rs, src/core/store_meta.rs, src/cli/commands/admin.rs","id":"bd-3m5.35","labels":[],"priority":2,"status":"closed","title":"Phase 7: admin.reload_policies + admin.rotate_replica_id","type":"task"}
{"_at":[1765835871893,0],"_by":"darin@dusk","_v":{"acceptance_criteria":[[1765744932476,0],"darin@book"],"claim":[[1765787271584,0],"darin@dusk"],"description":[[1765744932476,0],"darin@book"],"design":[[1765744932476,0],"darin@book"],"estimated_minutes":[[1765744932476,0],"darin@book"],"external_ref":[[1765744932476,0],"darin@book"],"labels":[[1765744932476,0],"darin@book"],"priority":[[1765744932476,0],"darin@book"],"source_repo":[[1765744932476,0],"darin@book"],"title":[[1765744932476,0],"darin@book"],"type":[[1765744932476,0],"darin@book"]},"assignee":"darin@dusk","assignee_at":[1765787271584,0],"assignee_expires":1765790871584,"closed_at":[1765835871893,0],"closed_by":"darin@dusk","closed_reason":"Implemented WAL-based durability. Replaced local git commits with atomic WAL file writes (~10x faster). Recovery on startup merges WAL with git state. Unit tests pass; full kill -9 integration test deferred.","created_at":[1765744932476,0],"created_by":"darin@book","description":"**Problem**\nMutations update in-memory state and schedule a sync later. If the process crashes or power dies before the debounce fires, acknowledged work is lost.\n\n**Design Options**\n\n*Option A:* Local WAL/journal\nAppend-only ops or periodic snapshot in the socket dir; replay on daemon start.\n\n*Option B:* Immediate local-only git commit  \nOn each mutation, write a local-only beads commit immediately (durable), push/compact later. Adds commits but can squash in compaction pass.\n\n**Design Notes**\nUser concern: Option B adds commits. Consider squash-on-push or a separate local ref that gets force-pushed after compaction.\n\n**Acceptance**\n- [ ] Crash after acknowledged mutation doesnt lose data\n- [ ] Recovery mechanism tested (kill -9 during burst, restart, verify state)\n- [ ] Performance acceptable (write latency)\n\n**Files:** src/daemon/mod.rs, src/daemon/executor.rs","id":"bd-dqe","labels":[],"priority":2,"status":"closed","title":"Durability gap: ops succeed before anything hits disk","type":"bug"}
