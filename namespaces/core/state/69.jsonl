{"_at":[1768398416289,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@book","created_at":[1768178814317,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nOperators need to reload namespace policies live and recover from replica_id collision.\n\n**Context**\n- REALTIME_PLAN.md ยง0.4 (reload semantics), ยง2.1.1 (replica_id collision)\n\n**Design**\n- admin.reload_policies: reloads namespaces.toml, validates, applies safe live changes\n  - Safe to apply: visibility, ready_eligible, retention windows, ttl_basis\n  - Requires restart: checkpoint group membership, replication listen params\n  - Returns diff summary (applied vs requires_restart)\n- admin.rotate_replica_id: generates new replica_id, updates meta.json, logs old->new mapping\n  - Used for recovery from duplicated store directories\n  - New replica starts with origin_seq=0 for new identity\n\n**Acceptance**\n- [ ] admin.reload_policies applies safe changes, reports restart-required changes\n- [ ] admin.rotate_replica_id generates new UUID and persists\n- [ ] CLI `bd admin reload-policies` and `bd admin rotate-replica-id` work\n- [ ] Tests verify policy reload diff\n\n**Files:** src/daemon/admin.rs, src/core/store_meta.rs, src/cli/commands/admin.rs","id":"bd-3m5.35","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Phase 7: admin.reload_policies + admin.rotate_replica_id","type":"task"}
{"_at":[1765835871893,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@dusk","closed_reason":"Implemented WAL-based durability. Replaced local git commits with atomic WAL file writes (~10x faster). Recovery on startup merges WAL with git state. Unit tests pass; full kill -9 integration test deferred.","created_at":[1765744932476,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nMutations update in-memory state and schedule a sync later. If the process crashes or power dies before the debounce fires, acknowledged work is lost.\n\n**Design Options**\n\n*Option A:* Local WAL/journal\nAppend-only ops or periodic snapshot in the socket dir; replay on daemon start.\n\n*Option B:* Immediate local-only git commit  \nOn each mutation, write a local-only beads commit immediately (durable), push/compact later. Adds commits but can squash in compaction pass.\n\n**Design Notes**\nUser concern: Option B adds commits. Consider squash-on-push or a separate local ref that gets force-pushed after compaction.\n\n**Acceptance**\n- [ ] Crash after acknowledged mutation doesnt lose data\n- [ ] Recovery mechanism tested (kill -9 during burst, restart, verify state)\n- [ ] Performance acceptable (write latency)\n\n**Files:** src/daemon/mod.rs, src/daemon/executor.rs","id":"bd-dqe","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Durability gap: ops succeed before anything hits disk","type":"bug"}
