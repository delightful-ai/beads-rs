{"_at":[1768492349651,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@book","created_at":[1765690393596,0],"created_by":"darin@darinsmcstudio2.lan","description":"## What's Wrong\nInstall script fetches `releases/latest` unauthenticated and downloads a tarball without any integrity verification (checksum/signature). It may also fail due to GitHub API rate limits.\n\n## Where\n- scripts/install.sh: uses https://api.github.com/.../releases/latest and grep/sed parsing\n- scripts/install.sh: downloads release asset and untars with no checksum\n\n## Why It Matters\n- Security: users execute a network script piping to bash; we should verify what we download.\n- Reliability: rate limiting or JSON format changes can break installs.\n\n## Suggested Fix\n- Publish checksums (e.g., SHA256SUMS) as release assets and verify before install.\n- Prefer GitHub release page redirect for latest tag, or allow `BD_VERSION` override.\n- Use `jq` when available; fallback to robust parsing.\n\n## Acceptance\n- Installer verifies integrity of downloaded binary.\n- Installer supports explicit version pinning.","id":"bd-0y9","labels":{"cc":{"max":{}},"entries":{}},"priority":3,"status":"closed","title":"Installer hardening: checksum verification + rate-limit robustness","type":"chore"}
{"_at":[1768410931843,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@book","created_at":[1768180834183,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nPhase 7 implementation must be verified to complete the realtime v0.5 epic.\n\n**Context**\n- REALTIME_PLAN.md §18: admin.status correctness under load\n- Depends on: Phase 7 implementation + Phase 7 test infrastructure\n\n**Design**\nDeterministic tests for:\n- Subscribe streaming: events arrive in order, no gaps\n- require_min_seen: subscription blocks until watermark condition met\n- admin.status consistency: watermarks + segment stats are coherent under load\n- admin.status monotonicity: watermarks never regress\n- Concurrent subscriptions: multiple clients receive same events\n\n**Acceptance**\n- [ ] tests/phase7_subscribe.rs: streaming subscription tests\n- [ ] tests/phase7_admin_status.rs: admin.status under load tests\n- [ ] Test: watermarks are monotonic during concurrent mutations\n- [ ] Test: segment stats match actual WAL files\n- [ ] cargo test phase7_ passes\n\n**Files:** tests/phase7_subscribe.rs (new), tests/phase7_admin_status.rs (new)","id":"bd-3m5.66","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Phase 7 tests: streaming + admin.status under load","type":"task"}
{"_at":[1768381732360,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@book","created_at":[1768271803077,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nDecodeError is rich (non_canonical, decode limits, trailing bytes), but replay collapses decode failures into wal_corrupt and there is no visible mapping for replication error frames. REALTIME_ERRORS.md expects actionable codes (invalid_request, frame_too_large, batch_too_large, non_canonical).\n\n**Where**\n- src/core/event.rs: DecodeError\n- src/daemon/wal/replay.rs: decode errors -> wal_corrupt\n- replication ingress path (Phase 5)\n\n**Design**\n- Add DecodeError -> ErrorPayload mapping for replication/IPC ingress.\n- Use non_canonical for canonical CBOR violations; size-related errors map to frame_too_large/batch_too_large; other semantic decode errors -> invalid_request.\n\n**Acceptance**\n- Replication ERROR frames include realtime codes for decode limits/non_canonical.\n- Non-canonical CBOR is not reported as wal_corrupt in network paths.\n\n**Files**\n- src/core/event.rs\n- src/daemon/* replication ingress code (bd-3m5.17/48)\n- src/daemon/ipc.rs (if IPC shares mapping)","id":"bd-3m5.78","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Replication ingress: map DecodeError to realtime codes","type":"task"}
{"_at":[1768803014488,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@book","created_at":[1768779166365,0],"created_by":"darin@darinsmcstudio2.lan","description":"tests/integration/daemon/subscribe.rs uses manual polling + 30s MAX_WAIT. Use ReadConsistency require_min_seen + wait_timeout_ms tied to expected seqs (from receipts) so tests block deterministically without repeated sleep/reconnect loops.","id":"bd-bv15","labels":{"cc":{"max":{}},"entries":{}},"priority":3,"status":"closed","title":"Subscribe integration tests: replace sleep loops with read gating","type":"chore"}
{"_at":[1768721558420,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@book","created_at":[1768710062452,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nEquivocation paths are opt-in; it is easy to forget to exercise them in model runs.\n\n**Design**\n- Add a documented command (and optionally a CI/just target) that runs the repl model with --equivocate.\n- Keep default equivocation off to avoid inflating baseline runs.\n\n**Acceptance**\n- [ ] There is a named command/target that runs with --equivocate.\n- [ ] No change to default model behavior.\n\n**Files**\n- justfile or scripts/ (if adding a target)\n- beads_stateright_models/examples/repl_core_machine.rs (docs/help text if needed)","id":"bd-ir5j","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Stateright repl: add equivocation coverage run","type":"chore"}
{"_at":[1768529304404,0],"_by":"darin@darinsmcstudio2.lan","acceptance_criteria":"- [ ] TxnId derivation incorporates actor identity (or full `Stamp`).\n- [ ] New test proves distinct actors produce different TxnIds for identical WriteStamp values.\n- [ ] Call sites updated accordingly.","assignee":"darin@book","created_at":[1768506351431,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\n`txn_id_for_stamp` (mutation engine) derives `TxnId` from `store_id` + `WriteStamp` (wall_ms, counter) only. The actor/replica identity is not included, so two actors with the same wall_ms/counter can produce identical TxnIds. This breaks the invariant that TxnIds are unique across actors and makes idempotency/debugging brittle.\n\n**Files**\n- src/daemon/mutation_engine.rs\n","design":"**Design**\n- Change `txn_id_for_stamp` to include actor identity (e.g., accept a full `Stamp` or `ActorId` and use it in the UUID v5 namespace/name).\n- Ensure the generated TxnId is stable for the same actor+stamp but distinct across actors.\n- Add a test that two different actors with the same wall_ms/counter produce different TxnIds.","id":"bd-lfxz","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"TxnId generation should include actor identity","type":"bug"}
{"_at":[1769577749197,0],"_by":"darin@darinsmcstudio2.lan","_v":{"workflow":[[1769563302921,0],"darin@darinsmcstudio2.lan"]},"acceptance_criteria":"- [ ] No direct println! in crates/beads-rs/src/cli/commands/*.rs (stdout via print_line/print_ok/print_json)\\n- [ ] Human-readable output stays in command files (local render_* helpers as needed)\\n- [ ] cargo clippy passes\\n- [ ] cargo test passes","assignee":"darin@darins-Mac-Studio-2.local","created_at":[1769309222772,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nSome CLI command handlers use direct `println\\!()` instead of going through render.rs, causing:\n- Inconsistent output formatting\n- Untestable output (no way to capture/verify)\n- Mixed patterns: some commands use `render::render_*()`, others use `print_ok()`, others raw println\n\nExamples found:\n- `src/cli/commands/close.rs:19`: `println\\!(\"✓ Closed {}: {}\", id.as_str(), reason_str);`\n- `src/cli/commands/update.rs:122`: direct println for success message\n- Similar patterns in reopen.rs, delete.rs, claim.rs, unclaim.rs\n\n**Design**\n1. Audit all command handlers in `src/cli/commands/` for direct println usage\n2. For each, either:\n   a. Add a `render_<command>()` function to render.rs, OR\n   b. Use existing `print_ok()` wrapper if output is simple \"✓ Done\" style\n3. Ensure JSON mode (`ctx.json`) is handled consistently — render functions should check this\n\nExample refactor for close.rs:\n```rust\n// Before (close.rs:19)\nprintln\\!(\"✓ Closed {}: {}\", id.as_str(), reason_str);\n\n// After (render.rs)\npub fn render_close(id: &BeadId, reason: Option<&str>) {\n    let reason_str = reason.map(|r| format\\!(\" ({})\", r)).unwrap_or_default();\n    println\\!(\"✓ Closed {}{}\", id.as_str(), reason_str);\n}\n\n// close.rs\nrender::render_close(&id, args.reason.as_deref());\n```\n\n**Acceptance**\n- [ ] No direct println\\!() in src/cli/commands/*.rs (except for --json output via print_json)\n- [ ] All human-readable output goes through render.rs functions\n- [ ] render.rs has consistent pattern: render_<command>() for each command with custom output\n- [ ] cargo clippy passes\n- [ ] cargo test passes\n\n**Files:** src/cli/commands/close.rs, src/cli/commands/update.rs, src/cli/commands/reopen.rs, src/cli/commands/delete.rs, src/cli/commands/claim.rs, src/cli/commands/unclaim.rs, src/cli/render.rs","id":"bd-x4zj","labels":{"cc":{"max":{}},"entries":{}},"notes":[{"at":[1769562626979,0],"author":"darin@darins-Mac-Studio-2.local","content":"Per user: keep rendering helpers in the command files; avoid central render.rs. Replace println! with local render_* helpers + print_ok/print_json.","id":"go-comment-bd-x4zj-1"},{"at":[1769562879544,0],"author":"darin@darins-Mac-Studio-2.local","content":"Per user: keep rendering helpers in the command files; avoid central render.rs. Replace println! with local render_* helpers + print_ok/print_json.","id":"go-comment-bd-x4zj-2"},{"at":[1769564808968,0],"author":"darin@darins-Mac-Studio-2.local","content":"Decision: keep rendering in the command files themselves; avoid moving output into render.rs or other centralized render helpers.","id":"go-comment-bd-x4zj-3"},{"at":[1769577749197,0],"author":"darin@darins-Mac-Studio-2.local","content":"Reaffirmed: keep rendering in the command files; avoid central render.rs helpers.","id":"go-comment-bd-x4zj-4"},{"at":[1769577749197,0],"author":"darin@darinsmcstudio2.lan","content":"Per user: keep rendering helpers in the command files; avoid central render.rs. Replace println! with local render_* helpers + print_ok/print_json.\n\nPer user: keep rendering helpers in the command files; avoid central render.rs. Replace println! with local render_* helpers + print_ok/print_json.\n\nDecision: keep rendering in the command files themselves; avoid moving output into render.rs or other centralized render helpers.\n\nReaffirmed: keep rendering in the command files; avoid central render.rs helpers.","id":"legacy-notes"}],"priority":2,"status":"closed","title":"Move direct println\\!() calls from CLI handlers to render.rs","type":"chore"}
