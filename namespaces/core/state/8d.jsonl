{"_at":[1768282020116,1],"_by":"darin@darinsmacstudio.lan","_v":{"acceptance_criteria":[[1768180519115,1],"darin@darinsmacstudio.lan"],"claim":[[1768279446938,1],"darin@darinsmacstudio.lan"],"description":[[1768180519115,1],"darin@darinsmacstudio.lan"],"design":[[1768180519115,1],"darin@darinsmacstudio.lan"],"estimated_minutes":[[1768178909582,1],"darin@darinsmacstudio.lan"],"external_ref":[[1768178909582,1],"darin@darinsmacstudio.lan"],"labels":[[1768178909582,1],"darin@darinsmacstudio.lan"],"priority":[[1768261544477,1],"darin@darinsmacstudio.lan"],"source_repo":[[1768178909582,1],"darin@darinsmacstudio.lan"],"title":[[1768187793333,1],"darin@darinsmacstudio.lan"],"type":[[1768178909582,1],"darin@darinsmacstudio.lan"]},"acceptance_criteria":"- [ ] Limits struct covers every constant in REALTIME_PLAN.md ยง0.19.\n- [ ] Replication rejects oversize frames and batches at decode time.\n- [ ] EventBody decoder rejects depth/map/array/byte-length violations.\n- [ ] WAL append rejects records > MAX_WAL_RECORD_BYTES before write.\n- [ ] Tests verify representative limits are enforced and surfaced as errors.","assignee":"darin@darinsmacstudio.lan","assignee_at":[1768279446938,1],"assignee_expires":1768283046938,"closed_at":[1768282020116,1],"closed_by":"darin@darinsmacstudio.lan","created_at":[1768178909582,1],"created_by":"darin@darinsmacstudio.lan","description":"**Problem**\nThe realtime plan hardcodes many safety limits (bytes, events, timeouts). Today these values are scattered or absent; different subsystems could silently diverge, which breaks the single canonical behavior the plan expects.\n\n**Context**\n- REALTIME_PLAN.md ยง0.19 (normative defaults + safety bounds) and ยง9.8 (flow control)\n- Stateright model: beads_stateright_models/src/realtime_types_sketch.rs (Limits struct and defaults)\n\n**Files:** src/core/limits.rs (new), src/core/mod.rs, src/daemon/repl/*, src/daemon/wal/*, src/git/checkpoint/import.rs, src/daemon/ipc.rs","design":"**Design**\n- Define a single Limits struct in src/core/limits.rs with all normative defaults (frame sizes, WAL bounds, CBOR decode bounds, HLC drift, backpressure, checkpoint limits).\n- Introduce small unit newtypes (Bytes, Events, Millis) or clearly name fields to avoid unit confusion across modules.\n- Thread Limits through EventBody decode, WAL append, replication framing, gap buffers, and IPC inflight control.\n- Make all limit enforcement explicit at module boundaries; failures return ErrorPayload(code=\"limit_exceeded\") with details of which limit tripped.\n- Allow overrides via config, but enforce that defaults are the plan values when no config is provided.","id":"bd-3m5.43","labels":[],"notes":[{"at":[1768189215964,1],"author":"darin@darinsmacstudio.lan","content":"Implemented Limits struct + defaults, config plumbing, IPC frame limit, WAL record size guard, and note/label limits with tests. Remaining for later phases: EventBody CBOR decode limits and replication frame/batch enforcement once those modules land.","id":"eTxm3dws"}],"priority":1,"status":"closed","title":"Cross-phase: Normative defaults constants + enforcement","type":"task"}
