{"_at":[1768209947141,1],"_by":"darin@darinsmacstudio.lan","_v":{"acceptance_criteria":[[1768195842867,1],"darin@darinsmacstudio.lan"],"claim":[[1768207364849,1],"darin@darinsmacstudio.lan"],"description":[[1768177825649,1],"darin@darinsmacstudio.lan"],"design":[[1768177825649,1],"darin@darinsmacstudio.lan"],"estimated_minutes":[[1768177825649,1],"darin@darinsmacstudio.lan"],"external_ref":[[1768177825649,1],"darin@darinsmacstudio.lan"],"labels":[[1768177825649,1],"darin@darinsmacstudio.lan"],"priority":[[1768177825649,1],"darin@darinsmacstudio.lan"],"source_repo":[[1768177825649,1],"darin@darinsmacstudio.lan"],"title":[[1768177825649,1],"darin@darinsmacstudio.lan"],"type":[[1768177825649,1],"darin@darinsmacstudio.lan"]},"acceptance_criteria":"- [ ] Database initializes with expected tables and indices.\n- [ ] WalIndexWriter and WalIndexReader trait methods are implemented.\n- [ ] Schema version is stored and validated on open.","assignee":"darin@darinsmacstudio.lan","assignee_at":[1768207364849,1],"assignee_expires":1768210964849,"closed_at":[1768209947141,1],"closed_by":"darin@darinsmacstudio.lan","created_at":[1768177825649,1],"created_by":"darin@darinsmacstudio.lan","description":"**Problem**\nPhase 3: add WAL SQLite index with schema and reader and writer traits. There is no SQLite index today; WAL is a snapshot file. The realtime plan requires a rebuildable index for event lookup, idempotency, and watermarks.\n\n**Context**\n- REALTIME_PLAN.md ยง0.11 (schema decisions) and ยง6.2 (table layout)\n- SQLite PRAGMA choices in ยง6.4\n**Files:** src/daemon/wal/index.rs (new), src/daemon/wal/mod.rs, Cargo.toml (rusqlite)","design":"**Design**\n- Implement schema for events, watermarks, client_requests, origin_seq, segments, meta (per plan).\n- Add WalIndexWriter and WalIndexReader traits with methods from REALTIME_PLAN.md ยง6.1.\n- Use UUIDs as 16 byte BLOBs. Store event_ids as CBOR encoded Vec<EventId> in client_requests.\n- Configure SQLite with PRAGMA: journal_mode=WAL, synchronous=NORMAL (configurable), foreign_keys=ON, busy_timeout.\n- Add schema version in meta table and enforce upgrade rules.","id":"bd-3m5.10","labels":[],"priority":2,"status":"closed","title":"Phase 3: SQLite WAL index + WalIndex traits","type":"task"}
