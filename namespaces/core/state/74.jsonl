{"_at":[1768380009337,1],"_by":"darin@book","_v":{"acceptance_criteria":[[1768177947873,1],"darin@darinsmacstudio.lan"],"claim":[[1768377365379,1],"darin@book"],"description":[[1768177947873,1],"darin@darinsmacstudio.lan"],"design":[[1768177947873,1],"darin@darinsmacstudio.lan"],"estimated_minutes":[[1768177947873,1],"darin@darinsmacstudio.lan"],"external_ref":[[1768177947873,1],"darin@darinsmacstudio.lan"],"labels":[[1768177947873,1],"darin@darinsmacstudio.lan"],"priority":[[1768177947873,1],"darin@darinsmacstudio.lan"],"source_repo":[[1768177947873,1],"darin@darinsmacstudio.lan"],"title":[[1768177947873,1],"darin@darinsmacstudio.lan"],"type":[[1768177947873,1],"darin@darinsmacstudio.lan"]},"acceptance_criteria":"- [ ] Checkpoint export is scheduled and produces commits under new refs.\n- [ ] Dirty events during export schedule a follow up checkpoint.\n- [ ] Legacy sync remains available for migration but does not write new realtime refs.","assignee":"darin@book","assignee_at":[1768377365379,1],"assignee_expires":1768380965379,"closed_at":[1768380009337,1],"closed_by":"darin@book","created_at":[1768177947873,1],"created_by":"darin@darinsmacstudio.lan","description":"**Problem**\nPhase 6: integrate checkpoint scheduling and git ref wiring. Export and import modules alone are not used until daemon schedules checkpoints and writes the new refs.\n\n**Context**\n- REALTIME_PLAN.md §13.2 (refs), §14 (scheduler), §7.3 (startup flow)\n**Files:** src/git/checkpoint/*, src/daemon/scheduler.rs or new checkpoint runtime module, src/daemon/git_worker.rs, src/git/sync.rs (legacy)","design":"**Design**\n- Add checkpoint runtime that tracks dirty namespaces and schedules exports with debounce, max interval, and max events.\n- Write checkpoint commits to `refs/beads/<store_id>/<group>` and keep `refs/beads/meta` for discovery.\n- Ensure only one push in flight per group and coalesce when new events arrive.\n- Keep legacy `src/git/sync.rs` as read only migration path.","id":"bd-3m5.22","labels":[],"priority":2,"status":"closed","title":"Phase 6: Checkpoint scheduler + git ref wiring","type":"task"}
{"_at":[1768356244491,1],"_by":"darin@book","_v":{"acceptance_criteria":[[1768178940965,1],"darin@darinsmacstudio.lan"],"claim":[[1768353425914,1],"darin@book"],"description":[[1768178940965,1],"darin@darinsmacstudio.lan"],"design":[[1768178940965,1],"darin@darinsmacstudio.lan"],"estimated_minutes":[[1768178940965,1],"darin@darinsmacstudio.lan"],"external_ref":[[1768178940965,1],"darin@darinsmacstudio.lan"],"labels":[[1768178940965,1],"darin@darinsmacstudio.lan"],"priority":[[1768261543649,1],"darin@darinsmacstudio.lan"],"source_repo":[[1768178940965,1],"darin@darinsmacstudio.lan"],"title":[[1768185453534,1],"darin@darinsmacstudio.lan"],"type":[[1768178940965,1],"darin@darinsmacstudio.lan"]},"assignee":"darin@book","assignee_at":[1768353425914,1],"assignee_expires":1768357025914,"closed_at":[1768356244491,1],"closed_by":"darin@book","created_at":[1768178940965,1],"created_by":"darin@darinsmacstudio.lan","description":"**Problem**\nbd-3m5.17 is too large. Split: manager handles outbound peers and reconnection.\n\n**Context**\n- REALTIME_PLAN.md §9.1 (manager.rs)\n- Refines bd-3m5.17\n\n**Design**\n- Implement ReplicationManager in src/daemon/repl/manager.rs\n- Manages outbound peer connections from config (replicas.toml)\n- Handles reconnect with exponential backoff\n- Event fanout to connected sessions\n- Namespace scoping based on policy (replicate=anchors/peers/none)\n\n**Acceptance**\n- [ ] Manager connects to configured peers\n- [ ] Reconnect with backoff on disconnect\n- [ ] Events fanned out to eligible sessions\n- [ ] Namespace policy respected\n\n**Files:** src/daemon/repl/manager.rs","id":"bd-3m5.47","labels":[],"priority":1,"status":"closed","title":"Phase 5: Replication manager + outbound peer lifecycle","type":"task"}
{"_at":[1768488067449,1],"_by":"darin@book","_v":{"acceptance_criteria":[[1768444275583,1],"darin@book"],"claim":[[1768444275583,1],"darin@book"],"description":[[1768444275583,1],"darin@book"],"design":[[1768444275583,1],"darin@book"],"estimated_minutes":[[1768444275583,1],"darin@book"],"external_ref":[[1768444275583,1],"darin@book"],"labels":[[1768444275583,1],"darin@book"],"priority":[[1768444275583,1],"darin@book"],"source_repo":[[1768444275583,1],"darin@book"],"title":[[1768444275583,1],"darin@book"],"type":[[1768444275583,1],"darin@book"]},"closed_at":[1768488067449,1],"closed_by":"darin@book","created_at":[1768444275583,1],"created_by":"darin@book","description":"**Problem**\nREALTIME_PLAN §5.2.3 says *.wal.tmp files MUST be ignored and SHOULD be deleted if not referenced by wal.sqlite. Current replay ignores .tmp files but never cleans them up.\n\nEvidence:\n- src/daemon/wal/replay.rs list_segments only loads *.wal; no cleanup of *.wal.tmp.\n\n**Acceptance**\n- [ ] On startup/replay, delete .wal.tmp files not referenced in wal.sqlite segments table.\n- [ ] Log deletions for operator visibility.","id":"bd-3m5.92","labels":[],"priority":4,"status":"closed","title":"Startup does not clean up orphaned *.wal.tmp segments","type":"bug"}
