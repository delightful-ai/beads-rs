{"_at":[1768497048898,1],"_by":"darin@book","_v":{"acceptance_criteria":[[1768495449924,1],"darin@book"],"claim":[[1768496329466,1],"darin@book"],"description":[[1768495449924,1],"darin@book"],"design":[[1768495449924,1],"darin@book"],"estimated_minutes":[[1768495449924,1],"darin@book"],"external_ref":[[1768495449924,1],"darin@book"],"labels":[[1768495449924,1],"darin@book"],"priority":[[1768495449924,1],"darin@book"],"source_repo":[[1768495449924,1],"darin@book"],"title":[[1768495449924,1],"darin@book"],"type":[[1768495449924,1],"darin@book"]},"acceptance_criteria":"- [ ] Issue detail output includes namespace line\n- [ ] Issue lists include namespace indicator\n- [ ] Formatting is deterministic and covered by tests","assignee":"darin@book","assignee_at":[1768496329466,1],"assignee_expires":1768499929466,"closed_at":[1768497048898,1],"closed_by":"darin@book","created_at":[1768495449924,1],"created_by":"darin@book","description":"**Problem**\nHuman CLI output (show/list/ready/blocked/stale) does not display namespace, which is critical when multiple namespaces are in play.\n\n**Design**\nExtend render helpers in src/cli/render.rs to show `namespace` for issue detail and list rows. Keep formatting concise and deterministic.\n\n**Files**\n- src/cli/render.rs","id":"bd-1qt","labels":[],"priority":2,"status":"closed","title":"Show namespace in CLI issue outputs","type":"feature"}
{"_at":[1768271110142,1],"_by":"darin@darinsmacstudio.lan","_v":{"acceptance_criteria":[[1768180571202,1],"darin@darinsmacstudio.lan"],"claim":[[1768268939105,1],"darin@darinsmacstudio.lan"],"description":[[1768180571202,1],"darin@darinsmacstudio.lan"],"design":[[1768180571202,1],"darin@darinsmacstudio.lan"],"estimated_minutes":[[1768177879615,1],"darin@darinsmacstudio.lan"],"external_ref":[[1768177879615,1],"darin@darinsmacstudio.lan"],"labels":[[1768177879615,1],"darin@darinsmacstudio.lan"],"priority":[[1768261542409,1],"darin@darinsmacstudio.lan"],"source_repo":[[1768177879615,1],"darin@darinsmacstudio.lan"],"title":[[1768177879615,1],"darin@darinsmacstudio.lan"],"type":[[1768177879615,1],"darin@darinsmacstudio.lan"]},"acceptance_criteria":"- [ ] Encode/decode roundtrip tests for each replication message type.\n- [ ] VerifiedEvent typestate prevents forwarding events with deferred prev checks.\n- [ ] Oversized frames and batches are rejected deterministically with correct error codes.\n- [ ] Error frames serialize to the same schema as IPC ErrorPayload.","assignee":"darin@darinsmacstudio.lan","assignee_at":[1768268939105,1],"assignee_expires":1768272539105,"closed_at":[1768271110142,1],"closed_by":"darin@darinsmacstudio.lan","created_at":[1768177879615,1],"created_by":"darin@darinsmacstudio.lan","description":"**Problem**\nReplication needs a typed, verifiable on wire protocol. Today there are no CBOR frame types or verification state; without a typestate pipeline, callers can accidentally skip hash or prev link checks and still treat events as valid.\n\n**Context**\n- REALTIME_PLAN.md ยง9.1-9.6 (frame definitions and rules), ยง0.6 (hashing over EventBody bytes)\n- REALTIME_ERRORS.md (error payload shape)\n- Stateright model: beads_stateright_models/src/realtime_types_sketch.rs (EventBytes, EventFrameV1, VerifiedEventAny)\n\n**Files:** src/daemon/repl/frame.rs (new), src/daemon/repl/proto.rs (new), src/daemon/repl/mod.rs (new), src/core/event.rs","design":"**Design**\n- Define CBOR envelope `{ v, type, body }` and per-message bodies (HELLO, WELCOME, EVENTS, ACK, WANT, ERROR) with spec field names.\n- Introduce EventFrameV1 that carries EventId, sha256, prev_sha256, and EventBytes<Opaque>.\n- Add verification pipeline types: VerifiedEvent<PrevVerified> vs VerifiedEvent<PrevDeferred> (or equivalent) so callers cannot treat a deferred prev check as fully verified.\n- Enforce MAX_FRAME_BYTES, MAX_EVENT_BATCH_BYTES, and decoding limits before allocating large buffers; reject oversize frames with ERROR(code=\"frame_too_large\").\n- Keep ErrorPayload consistent with IPC; ERROR frames use the same schema and codes.","id":"bd-3m5.15","labels":[],"priority":1,"status":"closed","title":"Phase 5: Replication protocol types + framing","type":"task"}
{"_at":[1768535163198,1],"_by":"darin@book","_v":{"acceptance_criteria":[[1768506367556,1],"darin@book"],"claim":[[1768535074895,1],"darin@book"],"description":[[1768506367556,1],"darin@book"],"design":[[1768506367556,1],"darin@book"],"estimated_minutes":[[1768506367556,1],"darin@book"],"external_ref":[[1768506367556,1],"darin@book"],"labels":[[1768506367556,1],"darin@book"],"priority":[[1768506367556,1],"darin@book"],"source_repo":[[1768506367556,1],"darin@book"],"title":[[1768506367556,1],"darin@book"],"type":[[1768506367556,1],"darin@book"]},"acceptance_criteria":"- [ ] No duplicate hard-coded record header length remains.\n- [ ] `estimated_record_bytes` uses the shared record header size.","assignee":"darin@book","assignee_at":[1768535074895,1],"assignee_expires":1768538674895,"closed_at":[1768535163198,1],"closed_by":"darin@book","created_at":[1768506367556,1],"created_by":"darin@book","description":"**Problem**\n`mutation_engine.rs` defines `RECORD_HEADER_BASE_LEN = 88`, duplicating the canonical constant in `wal/record.rs`. If the WAL header layout changes, `estimated_record_bytes` will silently become wrong, causing brittle sizing logic.\n\n**Files**\n- src/daemon/mutation_engine.rs\n- src/daemon/wal/record.rs\n","design":"**Design**\n- Expose a shared constant or accessor from `wal/record.rs` (e.g., `RecordHeader::base_len()` or `RECORD_HEADER_BASE_LEN` as `pub(crate)`).\n- Replace the magic number in `mutation_engine.rs` with the shared value.","id":"bd-yiof","labels":[],"priority":3,"status":"closed","title":"Deduplicate WAL record header base length constant","type":"chore"}
{"_at":[1765773848939,0],"_by":"darin@dusk","_v":{"acceptance_criteria":[[1765744929887,0],"darin@book"],"claim":[[1765773843836,0],"darin@dusk"],"description":[[1765744929887,0],"darin@book"],"design":[[1765744929887,0],"darin@book"],"estimated_minutes":[[1765744929887,0],"darin@book"],"external_ref":[[1765744929887,0],"darin@book"],"labels":[[1765744929887,0],"darin@book"],"priority":[[1765744929887,0],"darin@book"],"source_repo":[[1765744929887,0],"darin@book"],"title":[[1765744929887,0],"darin@book"],"type":[[1765744929887,0],"darin@book"]},"assignee":"darin@dusk","assignee_at":[1765773843836,0],"assignee_expires":1765777443836,"closed_at":[1765773848939,0],"closed_by":"darin@dusk","created_at":[1765744929887,0],"created_by":"darin@book","description":"**Problem**\nIn `src/git/collision.rs`, collision resolution remaps the loser and writes a tombstone for the old ID using a \"resolution stamp\". But the merge rule in `core/state.rs` is: tombstone wins unless the beads `updated_stamp()` is strictly newer.\n\nIf the tombstone stamp is newer than the winner beads updated stamp (likely, since resolution stamp is generated \"now\"), **the winner gets deleted during join**. This violates spec ยง4.1.1 (\"winner retains original id\") and is catastrophic.\n\n**Design Options**\n\n*Option A (cleanest):* Lineage-scoped tombstones\nTombstone includes the losing beads `created` stamp (or content-hash) so it only kills that lineage, not the winner occupying the ID.\n\n*Option B (minimal change):* Emit two stamps on collision resolution\n- `t_del` for the loser-id tombstone  \n- `t_win` for a no-op \"bump\" on the winner bead so `t_win > t_del`\nThis makes the winner survive the delete rule while preventing loser resurrection.\n\n**Acceptance**\n- [ ] Deterministic test: collision where winner is older, loser is newer, resolution happens later\n- [ ] Winner survives resolution in all timestamp orderings\n- [ ] Loser cannot resurrect after resolution\n- [ ] Spec compliance verified\n\n**Files:** src/git/collision.rs, src/core/state.rs","id":"bd-zvn","labels":[],"priority":0,"status":"closed","title":"Fix collision resolution: winner can be deleted by resolution tombstone","type":"bug"}
