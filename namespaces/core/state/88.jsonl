{"_at":[1768915341492,0],"_by":"darin@darinsmcstudio2.lan","acceptance_criteria":"- [ ] updated_at reflects labels/notes changes\n\n**Invariants to re-verify**\n- [ ] updated_at changes when labels/notes change without field edits","assignee":"darin@book","created_at":[1768894654303,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nupdated_at must reflect label/note changes after BeadView refactor.\n\n**Files**\n- src/daemon/query_model.rs\n- src/api/issues.rs\n- src/daemon/query_executor.rs","design":"Add tests to ensure updated_at changes when labels/notes change without touching core bead fields.","id":"bd-3zoj.18","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Tests: updated_at includes labels/notes","type":"task"}
{"_at":[1768489720581,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@book","created_at":[1768483169469,0],"created_by":"darin@darinsmcstudio2.lan","description":"","id":"bd-wlh","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"src/daemon/server.rs:1164 TestEnv.store_id unused triggers cargo test warnings","type":"chore"}
{"_at":[1768622404673,0],"_by":"darin@darinsmcstudio2.lan","created_at":[1768622404673,0],"created_by":"darin@darinsmcstudio2.lan","description":"","design":"Port the orphan detection feature from Go beads to beads-rs.\n\n## What it does\n\nScans git commit history for issue IDs (bd-xxx pattern) and identifies issues that:\n1. Are referenced in commit messages\n2. Remain in open or in_progress status in the database\n3. Should have been closed but weren't\n\nThis helps find work that's been implemented but not formally closed.\n\n## Implementation approach\n\n**Location**: `src/cli/orphans.rs` (new file), exposed via `src/cli/mod.rs`\n\n**Command structure**:\n```rust\npub struct OrphansArgs {\n    #[arg(long)]\n    json: bool,\n    #[arg(long)]\n    details: bool,\n    #[arg(long, short)]\n    fix: bool,  // Close orphaned issues with confirmation\n}\n```\n\n**Core logic**:\n1. Use git2-rs to walk commit history\n2. Scan commit messages for bd-xxx patterns using regex\n3. Query daemon for status of each referenced issue\n4. Filter for issues still open/in_progress\n5. Build orphan list with metadata (latest commit hash, message)\n\n**Output**:\n- Human mode: Pretty table with issue ID, title, status, latest commit\n- JSON mode: Machine-readable array of orphan objects\n- Details mode: Include full commit info\n\n**Fix mode**:\n- Confirm with user (Y/n prompt)\n- Call daemon to close each orphaned issue with reason \"Implemented\"\n- Report success/failure for each\n\n## Files to reference\n\nGo implementation: `/Users/darin/Projects/beads-rs-macstudio/tmp/beads/cmd/bd/orphans.go`\nUses shared doctor package: `/Users/darin/Projects/beads-rs-macstudio/tmp/beads/cmd/bd/doctor/`\n\n## Design notes\n\n- **Shared utility**: The orphan detection logic should be in `src/core/` or `src/git/` as a reusable function, not just in CLI.\n- **Pattern matching**: Use same regex pattern as Go beads for consistency: `bd-[a-z0-9]{5,6}`\n- **Performance**: For large repos, consider limiting commit scan depth or adding --since flag\n- **Edge cases**: \n  - External references (external:xxx) should be ignored\n  - Closed issues should be filtered out\n  - Tombstones (deleted issues) should be handled\n\n## Questions to resolve\n\n1. Should orphan detection be part of `bd doctor` or standalone command?\n2. Do we want to scan all branches or just current branch?\n3. Should we cache commit scan results?","id":"bd-ze0x.7","labels":{"cc":{"max":{}},"entries":{"human-needed":[{"counter":15600066176865691988,"replica":"5de5f19c-7f1b-43e2-dbe7-6244ded70993"}]}},"priority":2,"status":"open","title":"Implement bd orphans command - Find issues referenced in commits but never closed","type":"feature"}
