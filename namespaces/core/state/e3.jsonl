{"_at":[1768268810681,1],"_by":"darin@darinsmacstudio.lan","_v":{"acceptance_criteria":[[1768195826893,1],"darin@darinsmacstudio.lan"],"claim":[[1768267283803,1],"darin@darinsmacstudio.lan"],"description":[[1768177849326,1],"darin@darinsmacstudio.lan"],"design":[[1768177849326,1],"darin@darinsmacstudio.lan"],"estimated_minutes":[[1768177849326,1],"darin@darinsmacstudio.lan"],"external_ref":[[1768177849326,1],"darin@darinsmacstudio.lan"],"labels":[[1768177849326,1],"darin@darinsmacstudio.lan"],"priority":[[1768261541369,1],"darin@darinsmacstudio.lan"],"source_repo":[[1768177849326,1],"darin@darinsmacstudio.lan"],"title":[[1768177849326,1],"darin@darinsmacstudio.lan"],"type":[[1768177849326,1],"darin@darinsmacstudio.lan"]},"acceptance_criteria":"- [ ] MutationEngine builds a deterministic EventBody draft plus request_sha256 from a canonicalized request.\n- [ ] Limit enforcement rejects oversize requests before WAL append.\n- [ ] MutationEngine produces plan output without mutating CanonicalState.","assignee":"darin@darinsmacstudio.lan","assignee_at":[1768267283803,1],"assignee_expires":1768270883803,"closed_at":[1768268810681,1],"closed_by":"darin@darinsmacstudio.lan","created_at":[1768177849326,1],"created_by":"darin@darinsmacstudio.lan","description":"**Problem**\nPhase 4: implement a MutationEngine that turns IPC ops into a single EventBody with canonical request hash and stamps. Current mutations in `src/daemon/executor.rs` mutate state directly; there is no event planning or idempotency digest.\n\n**Context**\n- REALTIME_PLAN.md ยง8.1 and ยง8.2 (mutation planning and request_sha256)\n- request_sha256 storage in WAL headers (REALTIME_PLAN.md ยง0.11)\n**Files:** src/daemon/mutation_engine.rs (new), src/daemon/ops.rs, src/daemon/clock.rs","design":"**Design**\n- Add a MutationEngine that validates inputs, enforces limits (MAX_OPS_PER_TXN, MAX_NOTE_BYTES), and builds one EventBody (TxnV1).\n- Compute canonical request_sha256 from a normalized request that excludes retry only fields (wait_timeout_ms, durability wait targets).\n- Mint txn_id and stamps using HLC; ensure event_time_ms equals stamp wall time and populate hlc_max.\n- Return EventDraft { event_body, request_sha256, client_request_id } for WAL append.","id":"bd-3m5.12","labels":[],"priority":1,"status":"closed","title":"Phase 4: MutationEngine planning + request hash","type":"task"}
{"_at":[1768542341282,1],"_by":"darin@book","_v":{"acceptance_criteria":[[1768508733513,1],"darin@book"],"claim":[[1768541763684,1],"darin@book"],"description":[[1768508733513,1],"darin@book"],"design":[[1768508733513,1],"darin@book"],"estimated_minutes":[[1768508733513,1],"darin@book"],"external_ref":[[1768508733513,1],"darin@book"],"labels":[[1768508733513,1],"darin@book"],"priority":[[1768508733513,1],"darin@book"],"source_repo":[[1768508733513,1],"darin@book"],"title":[[1768508733513,1],"darin@book"],"type":[[1768508733513,1],"darin@book"]},"acceptance_criteria":"- [ ] `src/api/mod.rs` is a re-export hub only.\n- [ ] Domain types live in dedicated files.\n- [ ] No behavior change; tests pass.","assignee":"darin@book","assignee_at":[1768541763684,1],"assignee_expires":1768545363684,"closed_at":[1768542341282,1],"closed_by":"darin@book","created_at":[1768508733513,1],"created_by":"darin@book","description":"**Problem**\n- `src/api/mod.rs` is ~900 LOC and mixes admin, realtime, issues, and deps types.\n- Discoverability is low and changes are noisy.\n\n**Files:**\n- src/api/mod.rs\n- src/api/admin.rs\n- src/api/issues.rs\n- src/api/realtime.rs\n- src/api/deps.rs (as needed)","design":"- Split `api/mod.rs` into domain modules and re-export from `mod.rs`.\n- Keep struct names and serde behavior unchanged.\n- Update imports across daemon/cli as needed.","id":"bd-6w3l","labels":[],"priority":2,"status":"closed","title":"Split api/mod.rs into domain modules","type":"chore"}
{"_at":[1765787088948,0],"_by":"darin@dusk","_v":{"acceptance_criteria":[[1765781522273,0],"darin@dusk"],"claim":[[1765781522273,0],"darin@dusk"],"description":[[1765781522273,0],"darin@dusk"],"design":[[1765781522273,0],"darin@dusk"],"estimated_minutes":[[1765781522273,0],"darin@dusk"],"external_ref":[[1765781522273,0],"darin@dusk"],"labels":[[1765781522273,0],"darin@dusk"],"priority":[[1765781522273,0],"darin@dusk"],"source_repo":[[1765781522273,0],"darin@dusk"],"title":[[1765781522273,0],"darin@dusk"],"type":[[1765781522273,0],"darin@dusk"]},"closed_at":[1765787088948,0],"closed_by":"darin@dusk","closed_reason":"Refactored executor.rs to use require_live/require_live_mut with MapLiveError trait. Eliminated all .unwrap() calls on bead lookups.","created_at":[1765781522273,0],"created_by":"darin@dusk","description":"executor.rs has many instances of the check-then-unwrap pattern:\n```rust\nif repo_state.state.get_live(id).is_none() {\n    if repo_state.state.get_tombstone(id).is_some() {\n        return Response::err(OpError::BeadDeleted(id.clone()));\n    }\n    return Response::err(OpError::NotFound(id.clone()));\n}\n// ... later ...\nlet bead = repo_state.state.get_live_mut(id).unwrap();\n```\n\nShould use the new require_live/require_live_mut helpers added in bd-ieo.\n\nFiles: src/daemon/executor.rs","id":"bd-n11","labels":[],"priority":3,"status":"closed","title":"Refactor executor.rs to use require_live helpers","type":"chore"}
