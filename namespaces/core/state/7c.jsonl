{"_at":[1770511093702,0],"_by":"darin@darinsmcstudio2.lan","acceptance_criteria":"- [ ] Temporary re-exports removed\n- [ ] Visibility tightened to intended surface\n- [ ] No downstream compile regressions","assignee":"darin@darins-Mac-Studio-2.local","created_at":[1770498238921,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nTemporary shims can become permanent scatter if not removed.","design":"Delete migration re-exports, tighten module visibility, and ensure single source of truth per boundary type.","id":"bd-21eg.27","labels":{"cc":{"max":{}},"entries":{}},"notes":[{"at":[1770507975971,0],"author":"darin@darins-Mac-Studio-2.local","content":"Started .27 cleanup with low-risk shim removals plus file-level dependency audit. Landed: (1) removed beads-daemon crate compatibility alias `mod daemon { pub use crate::metrics; }` by rewriting admission.rs to import `crate::metrics` directly, and (2) removed CLI daemon command type re-export shim by switching command enum/dispatch to `beads_cli::commands::daemon::DaemonCmd` directly (daemon.rs now only renders daemon info text). Validation: cargo check -p beads-daemon, cargo check -p beads-rs, cargo test -p beads-rs --test integration -- cli::critical_path:: (6 pass), just dylint all pass. Remaining .27 work is larger import-retargeting for daemon/cli shim modules with active consumers.","id":"go-comment-bd-21eg.27-1"},{"at":[1770508398510,0],"author":"darin@darins-Mac-Studio-2.local","content":"Progress: removed additional temporary shim layers.\n- Deleted beads-rs CLI shim files: `src/cli/parsers.rs`, `src/cli/filters.rs`, `src/cli/validation.rs` after retargeting all CLI command imports.\n- Removed CLI daemon command type re-export shim usage by switching command typing/dispatch to `beads_cli::commands::daemon::DaemonCmd` directly.\n- Removed beads-daemon crate compatibility alias `mod daemon { pub use crate::metrics; }` and imported `crate::metrics` directly in compiled module(s).\nNo compile/test regressions in verification set.\nValidation: cargo check -p beads-rs, cargo check -p beads-daemon, cargo test -p beads-rs --test integration -- cli::critical_path:: (6 pass), just dylint, cargo check --workspace.","id":"go-comment-bd-21eg.27-2"},{"at":[1770511080398,0],"author":"darin@darins-Mac-Studio-2.local","content":"Completed a major .27 cleanup pass removing additional temporary boundary shims and tightening visibility:\n\n1) Removed daemon wrapper modules in beads-rs and retargeted all callsites (src + tests) to owning crates:\n- deleted `crates/beads-rs/src/daemon/{admission,broadcast,clock,git_lane,remote,scheduler}.rs`\n- imports now use `beads_daemon::{admission,broadcast,clock,git_lane,remote,scheduler}` directly\n\n2) Removed temporary repl frame/proto module wrappers and retargeted callsites:\n- deleted `crates/beads-rs/src/daemon/repl/{frame,proto}.rs`\n- `repl/mod.rs` now re-exports frame/proto types/functions directly from `beads_daemon_core::repl::{frame,proto}`\n- internal/tests updated to consume owning module paths\n\n3) Removed temporary store wrapper modules:\n- deleted `crates/beads-rs/src/daemon/{store_lock,store_runtime}.rs`\n- internal imports retargeted to `crate::daemon::store::{lock,runtime}`\n- daemon top-level now explicitly re-exports stable lock/runtime boundary types\n\n4) Tightened visibility:\n- `crates/beads-rs/src/daemon/ipc/mod.rs` changed `ResponseExt` export to `pub(crate)`\n\n5) Removed migrate compatibility shim layer:\n- deleted `crates/beads-rs/src/migrate/mod.rs`\n- CLI migrate command now calls `beads_cli::migrate::import_go_export` directly\n\nValidation:\n- cargo check -p beads-rs\n- cargo check --workspace\n- cargo test -p beads-rs --test integration -- repl::ack::\n- cargo test -p beads-rs --test integration -- daemon::store_lock::\n- cargo test -p beads-rs --test integration --features slow-tests -- daemon::lifecycle:: (8 pass)\n- just dylint\nAll green.","id":"go-comment-bd-21eg.27-3"},{"at":[1770511093702,0],"author":"darin@darinsmcstudio2.lan","content":"Started .27 cleanup with low-risk shim removals plus file-level dependency audit. Landed: (1) removed beads-daemon crate compatibility alias `mod daemon { pub use crate::metrics; }` by rewriting admission.rs to import `crate::metrics` directly, and (2) removed CLI daemon command type re-export shim by switching command enum/dispatch to `beads_cli::commands::daemon::DaemonCmd` directly (daemon.rs now only renders daemon info text). Validation: cargo check -p beads-daemon, cargo check -p beads-rs, cargo test -p beads-rs --test integration -- cli::critical_path:: (6 pass), just dylint all pass. Remaining .27 work is larger import-retargeting for daemon/cli shim modules with active consumers.\n\nProgress: removed additional temporary shim layers.\n- Deleted beads-rs CLI shim files: `src/cli/parsers.rs`, `src/cli/filters.rs`, `src/cli/validation.rs` after retargeting all CLI command imports.\n- Removed CLI daemon command type re-export shim usage by switching command typing/dispatch to `beads_cli::commands::daemon::DaemonCmd` directly.\n- Removed beads-daemon crate compatibility alias `mod daemon { pub use crate::metrics; }` and imported `crate::metrics` directly in compiled module(s).\nNo compile/test regressions in verification set.\nValidation: cargo check -p beads-rs, cargo check -p beads-daemon, cargo test -p beads-rs --test integration -- cli::critical_path:: (6 pass), just dylint, cargo check --workspace.\n\nCompleted a major .27 cleanup pass removing additional temporary boundary shims and tightening visibility:\n\n1) Removed daemon wrapper modules in beads-rs and retargeted all callsites (src + tests) to owning crates:\n- deleted `crates/beads-rs/src/daemon/{admission,broadcast,clock,git_lane,remote,scheduler}.rs`\n- imports now use `beads_daemon::{admission,broadcast,clock,git_lane,remote,scheduler}` directly\n\n2) Removed temporary repl frame/proto module wrappers and retargeted callsites:\n- deleted `crates/beads-rs/src/daemon/repl/{frame,proto}.rs`\n- `repl/mod.rs` now re-exports frame/proto types/functions directly from `beads_daemon_core::repl::{frame,proto}`\n- internal/tests updated to consume owning module paths\n\n3) Removed temporary store wrapper modules:\n- deleted `crates/beads-rs/src/daemon/{store_lock,store_runtime}.rs`\n- internal imports retargeted to `crate::daemon::store::{lock,runtime}`\n- daemon top-level now explicitly re-exports stable lock/runtime boundary types\n\n4) Tightened visibility:\n- `crates/beads-rs/src/daemon/ipc/mod.rs` changed `ResponseExt` export to `pub(crate)`\n\n5) Removed migrate compatibility shim layer:\n- deleted `crates/beads-rs/src/migrate/mod.rs`\n- CLI migrate command now calls `beads_cli::migrate::import_go_export` directly\n\nValidation:\n- cargo check -p beads-rs\n- cargo check --workspace\n- cargo test -p beads-rs --test integration -- repl::ack::\n- cargo test -p beads-rs --test integration -- daemon::store_lock::\n- cargo test -p beads-rs --test integration --features slow-tests -- daemon::lifecycle:: (8 pass)\n- just dylint\nAll green.","id":"legacy-notes"}],"priority":2,"status":"closed","title":"Remove temporary re-exports and tighten visibility boundaries","type":"chore"}
{"_at":[1768369154823,0],"_by":"darin@darinsmcstudio2.lan","acceptance_criteria":"- [ ] Import rejects mismatched hashes.\n- [ ] JSONL parsing enforces line and shard size limits.\n- [ ] Merge output is deterministic for identical inputs.","assignee":"darin@book","created_at":[1768177935573,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nPhase 6: implement checkpoint import and verification (manifest_hash and content_hash). There is no importer for the new checkpoint layout.\n\n**Context**\n- REALTIME_PLAN.md ยง13.9 and ยง13.9.1 (import, verification, JSONL bounds)\n**Files:** src/git/checkpoint/import.rs (new), src/git/checkpoint/layout.rs, src/git/checkpoint/mod.rs","design":"**Design**\n- Read checkpoint tree or cache, verify manifest hashes and file hashes.\n- Validate content_hash from meta preimage.\n- Parse JSONL shards line by line with size bounds and merge into StoreState deterministically.\n- Return included watermarks and optional included_heads for seeding head sha.","id":"bd-3m5.21","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Phase 6: Checkpoint import + verification","type":"task"}
{"_at":[1768408384058,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@book","created_at":[1768180832727,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nPhase 7 tests need IPC streaming test client and load generation.\n\n**Context**\n- REALTIME_PLAN.md ยง18: admin.status correctness under load\n- Blocks Phase 7 testing bead\n\n**Design**\nCreate test infrastructure:\n- IPC streaming test client: subscribe, receive events, verify ordering\n- Load generator: concurrent mutations at configurable rate\n- admin.status snapshot collector: capture watermarks/segment stats over time\n- Consistency checker: verify watermarks are monotonic under load\n\n**Acceptance**\n- [ ] tests/fixtures/ipc_stream.rs with StreamingClient\n- [ ] tests/fixtures/load_gen.rs with LoadGenerator\n- [ ] tests/fixtures/admin_status.rs with StatusCollector\n- [ ] cargo test fixtures::ipc_stream passes\n\n**Files:** tests/fixtures/ipc_stream.rs (new), tests/fixtures/load_gen.rs (new), tests/fixtures/admin_status.rs (new)","id":"bd-3m5.65","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Phase 7 test infrastructure: IPC streaming client + load generator","type":"task"}
