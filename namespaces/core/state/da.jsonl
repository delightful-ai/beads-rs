{"_at":[1768538827687,0],"_by":"darin@darinsmcstudio2.lan","acceptance_criteria":"- [ ] Canonical store state lives in `StoreRuntime`, not `RepoState`.\n- [ ] Git lane metadata lives in `GitLaneState` (renamed file/module).\n- [ ] No name collision with `src/repo.rs`.\n- [ ] Tests pass.","assignee":"darin@book","created_at":[1768508732473,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\n- `RepoState` owns canonical `StoreState` plus git lane metadata, mixing concerns.\n- `StoreRuntime` holds `repo_state`, so store state is indirectly coupled to git operations.\n- `RepoState` name conflicts with `src/repo.rs` and is easy to open by mistake.\n\n**Files:**\n- src/daemon/repo.rs\n- src/daemon/store_runtime.rs\n- src/daemon/core.rs\n- src/git/sync.rs (only if types are referenced)","design":"- Move `StoreState` ownership into `StoreRuntime` (`state: StoreState`).\n- Rename `RepoState` to `GitLaneState` (or `CheckpointLaneState`) and keep only git/checkpoint metadata there.\n- Update `Daemon` maps to store `GitLaneState` separately from store runtime.\n- Remove unused fields like `wal_sequence` if they are now owned by WAL.\n- Update all references/imports.","id":"bd-1h02","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Decouple StoreState from RepoState (rename RepoState)","type":"chore"}
{"_at":[1770514339394,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@darins-Mac-Studio-2.local","created_at":[1770511160065,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\\nAfter phased migration, residual handler files in beads-rs can linger and create dual ownership/scatter.\\n\\n**Design**\\nSwitch final beads-rs CLI dispatch/entrypoint to beads-cli-owned command tree and delete migrated handler files/modules from beads-rs. Keep binary behavior and output compatibility unchanged.\\n\\n**Acceptance**\\n- [ ] beads-rs no longer owns migrated CLI command handler modules\\n- [ ] Command tree ownership is singular under beads-cli\\n- [ ] cargo test -p beads-rs --test integration -- cli::critical_path:: passes\\n\\n**Files:** crates/beads-rs/src/cli/*, crates/beads-cli/src/commands/*, crates/beads-rs/src/bin/main.rs","id":"bd-21eg.40","labels":{"cc":{"max":{}},"entries":{}},"notes":[{"at":[1770514339188,0],"author":"darin@darins-Mac-Studio-2.local","content":"Completed wrapper-finalization pass: removed dual ownership for migrated read-only command handlers by deleting beads-rs wrappers (list/search/ready/blocked/stale/count), routing dispatch directly to beads-cli handlers, and updating render_query to beads-cli render helpers. Kept behavior unchanged (same underlying handlers/arg types). Validation: cargo check -p beads-rs; cargo test -p beads-rs --test integration -- cli::critical_path:: (6/6 pass).","id":"go-comment-bd-21eg.40-1"},{"at":[1770514339394,0],"author":"darin@darinsmcstudio2.lan","content":"Completed wrapper-finalization pass: removed dual ownership for migrated read-only command handlers by deleting beads-rs wrappers (list/search/ready/blocked/stale/count), routing dispatch directly to beads-cli handlers, and updating render_query to beads-cli render helpers. Kept behavior unchanged (same underlying handlers/arg types). Validation: cargo check -p beads-rs; cargo test -p beads-rs --test integration -- cli::critical_path:: (6/6 pass).","id":"legacy-notes"}],"priority":1,"status":"closed","title":"Finalize CLI crate ownership and delete beads-rs command handlers","type":"task"}
{"_at":[1768432817252,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@book","closed_reason":"Switched tests to thread-local override_data_dir_for_tests; removed lock usage and added allow(dead_code) on lock APIs.","created_at":[1768431984087,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\\nUnit tests that override data dir grab a global lock (paths::lock_data_dir_for_tests) and serialize across the suite. This blocks parallel test execution and shows up as time spent waiting.\\n\\n**Design**\\nUse thread-local DataDirOverride (paths::override_data_dir_for_tests) in unit tests instead of global set_data_dir_for_tests + lock. Update affected tests to use RAII guard. Keep lock-based API for cases that truly need cross-thread overrides.\\n\\n**Acceptance**\\n- [ ] Tests no longer use lock_data_dir_for_tests when not needed\\n- [ ] Data dir override is scoped and does not leak\\n- [ ] Tests still pass in parallel\\n\\n**Files**: src/git/checkpoint/cache.rs, src/daemon/store_runtime.rs, src/daemon/core.rs","id":"bd-mvd","labels":{"cc":{"max":{}},"entries":{}},"priority":1,"status":"closed","title":"Remove global test data dir lock by using thread-local overrides","type":"task"}
{"_at":[1768777313215,0],"_by":"darin@darinsmcstudio2.lan","assignee":"darin@book","created_at":[1768774749880,0],"created_by":"darin@darinsmcstudio2.lan","description":"**Problem**\nLog level/filter is only controlled by `LOG` env or `-v`, so daemon log verbosity is not persistently configurable.\n\n**Design**\n- Add `logging.filter` (string) to config schema for `tracing_subscriber::EnvFilter` directives.\n- Add env override `BD_LOG_FILTER` (string). Precedence: LOG env > BD_LOG_FILTER > config.logging.filter > verbosity.\n- Update `telemetry::init` to build an EnvFilter that merges the chosen source.\n\n**Acceptance**\n- [ ] Config accepts `logging.filter = \"beads_rs=debug,metrics=info\"`.\n- [ ] `BD_LOG_FILTER` overrides config, `LOG` overrides both.\n- [ ] Tests updated or added for parsing/precedence.\n\n**Files:** src/config/schema.rs, src/config/merge.rs, src/telemetry.rs, src/bin/main.rs","id":"bd-wm65","labels":{"cc":{"max":{}},"entries":{}},"priority":2,"status":"closed","title":"Observability: configurable log filter/level","type":"feature"}
